/*! For license information please see forum.js.LICENSE.txt */
(()=>{var t={987:(t,o,e)=>{var n=/^\s+|\s+$/g,r=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,i=/^0o[0-7]+$/i,s=parseInt,c="object"==typeof e.g&&e.g&&e.g.Object===Object&&e.g,u="object"==typeof self&&self&&self.Object===Object&&self,l=c||u||Function("return this")(),f=Object.prototype.toString,m=Math.max,p=Math.min,d=function(){return l.Date.now()};function v(t){var o=typeof t;return!!t&&("object"==o||"function"==o)}function h(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&"[object Symbol]"==f.call(t)}(t))return NaN;if(v(t)){var o="function"==typeof t.valueOf?t.valueOf():t;t=v(o)?o+"":o}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(n,"");var e=a.test(t);return e||i.test(t)?s(t.slice(2),e?2:8):r.test(t)?NaN:+t}t.exports=function(t,o,e){var n,r,a,i,s,c,u=0,l=!1,f=!1,y=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function g(o){var e=n,a=r;return n=r=void 0,u=o,i=t.apply(a,e)}function b(t){var e=t-c;return void 0===c||e>=o||e<0||f&&t-u>=a}function w(){var t=d();if(b(t))return N(t);s=setTimeout(w,function(t){var e=o-(t-c);return f?p(e,a-(t-u)):e}(t))}function N(t){return s=void 0,y&&n?g(t):(n=r=void 0,i)}function x(){var t=d(),e=b(t);if(n=arguments,r=this,c=t,e){if(void 0===s)return function(t){return u=t,s=setTimeout(w,o),l?g(t):i}(c);if(f)return s=setTimeout(w,o),g(c)}return void 0===s&&(s=setTimeout(w,o)),i}return o=h(o)||0,v(e)&&(l=!!e.leading,a=(f="maxWait"in e)?m(h(e.maxWait)||0,o):a,y="trailing"in e?!!e.trailing:y),x.cancel=function(){void 0!==s&&clearTimeout(s),u=0,n=c=r=s=void 0},x.flush=function(){return void 0===s?i:N(d())},x}},648:(t,o,e)=>{var n=e(288).default;function r(){"use strict";t.exports=r=function(){return o},t.exports.__esModule=!0,t.exports.default=t.exports;var o={},e=Object.prototype,a=e.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function l(t,o,e){return Object.defineProperty(t,o,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[o]}try{l({},"")}catch(t){l=function(t,o,e){return t[o]=e}}function f(t,o,e,n){var r=o&&o.prototype instanceof d?o:d,a=Object.create(r.prototype),i=new V(n||[]);return a._invoke=function(t,o,e){var n="suspendedStart";return function(r,a){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===r)throw a;return{value:void 0,done:!0}}for(e.method=r,e.arg=a;;){var i=e.delegate;if(i){var s=L(i,e);if(s){if(s===p)continue;return s}}if("next"===e.method)e.sent=e._sent=e.arg;else if("throw"===e.method){if("suspendedStart"===n)throw n="completed",e.arg;e.dispatchException(e.arg)}else"return"===e.method&&e.abrupt("return",e.arg);n="executing";var c=m(t,o,e);if("normal"===c.type){if(n=e.done?"completed":"suspendedYield",c.arg===p)continue;return{value:c.arg,done:e.done}}"throw"===c.type&&(n="completed",e.method="throw",e.arg=c.arg)}}}(t,e,i),a}function m(t,o,e){try{return{type:"normal",arg:t.call(o,e)}}catch(t){return{type:"throw",arg:t}}}o.wrap=f;var p={};function d(){}function v(){}function h(){}var y={};l(y,s,(function(){return this}));var g=Object.getPrototypeOf,b=g&&g(g(_([])));b&&b!==e&&a.call(b,s)&&(y=b);var w=h.prototype=d.prototype=Object.create(y);function N(t){["next","throw","return"].forEach((function(o){l(t,o,(function(t){return this._invoke(o,t)}))}))}function x(t,o){function e(r,i,s,c){var u=m(t[r],t,i);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==n(f)&&a.call(f,"__await")?o.resolve(f.__await).then((function(t){e("next",t,s,c)}),(function(t){e("throw",t,s,c)})):o.resolve(f).then((function(t){l.value=t,s(l)}),(function(t){return e("throw",t,s,c)}))}c(u.arg)}var r;this._invoke=function(t,n){function a(){return new o((function(o,r){e(t,n,o,r)}))}return r=r?r.then(a,a):a()}}function L(t,o){var e=t.iterator[o.method];if(void 0===e){if(o.delegate=null,"throw"===o.method){if(t.iterator.return&&(o.method="return",o.arg=void 0,L(t,o),"throw"===o.method))return p;o.method="throw",o.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var n=m(e,t.iterator,o.arg);if("throw"===n.type)return o.method="throw",o.arg=n.arg,o.delegate=null,p;var r=n.arg;return r?r.done?(o[t.resultName]=r.value,o.next=t.nextLoc,"return"!==o.method&&(o.method="next",o.arg=void 0),o.delegate=null,p):r:(o.method="throw",o.arg=new TypeError("iterator result is not an object"),o.delegate=null,p)}function k(t){var o={tryLoc:t[0]};1 in t&&(o.catchLoc=t[1]),2 in t&&(o.finallyLoc=t[2],o.afterLoc=t[3]),this.tryEntries.push(o)}function P(t){var o=t.completion||{};o.type="normal",delete o.arg,t.completion=o}function V(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function _(t){if(t){var o=t[s];if(o)return o.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var e=-1,n=function o(){for(;++e<t.length;)if(a.call(t,e))return o.value=t[e],o.done=!1,o;return o.value=void 0,o.done=!0,o};return n.next=n}}return{next:F}}function F(){return{value:void 0,done:!0}}return v.prototype=h,l(w,"constructor",h),l(h,"constructor",v),v.displayName=l(h,u,"GeneratorFunction"),o.isGeneratorFunction=function(t){var o="function"==typeof t&&t.constructor;return!!o&&(o===v||"GeneratorFunction"===(o.displayName||o.name))},o.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,h):(t.__proto__=h,l(t,u,"GeneratorFunction")),t.prototype=Object.create(w),t},o.awrap=function(t){return{__await:t}},N(x.prototype),l(x.prototype,c,(function(){return this})),o.AsyncIterator=x,o.async=function(t,e,n,r,a){void 0===a&&(a=Promise);var i=new x(f(t,e,n,r),a);return o.isGeneratorFunction(e)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},N(w),l(w,u,"Generator"),l(w,s,(function(){return this})),l(w,"toString",(function(){return"[object Generator]"})),o.keys=function(t){var o=[];for(var e in t)o.push(e);return o.reverse(),function e(){for(;o.length;){var n=o.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},o.values=_,V.prototype={constructor:V,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(P),!t)for(var o in this)"t"===o.charAt(0)&&a.call(this,o)&&!isNaN(+o.slice(1))&&(this[o]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var o=this;function e(e,n){return i.type="throw",i.arg=t,o.next=e,n&&(o.method="next",o.arg=void 0),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n],i=r.completion;if("root"===r.tryLoc)return e("end");if(r.tryLoc<=this.prev){var s=a.call(r,"catchLoc"),c=a.call(r,"finallyLoc");if(s&&c){if(this.prev<r.catchLoc)return e(r.catchLoc,!0);if(this.prev<r.finallyLoc)return e(r.finallyLoc)}else if(s){if(this.prev<r.catchLoc)return e(r.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return e(r.finallyLoc)}}}},abrupt:function(t,o){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var r=n;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=o&&o<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=t,i.arg=o,r?(this.method="next",this.next=r.finallyLoc,p):this.complete(i)},complete:function(t,o){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&o&&(this.next=o),p},finish:function(t){for(var o=this.tryEntries.length-1;o>=0;--o){var e=this.tryEntries[o];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),P(e),p}},catch:function(t){for(var o=this.tryEntries.length-1;o>=0;--o){var e=this.tryEntries[o];if(e.tryLoc===t){var n=e.completion;if("throw"===n.type){var r=n.arg;P(e)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,o,e){return this.delegate={iterator:_(t),resultName:o,nextLoc:e},"next"===this.method&&(this.arg=void 0),p}},o}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports},288:t=>{function o(e){return t.exports=o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,o(e)}t.exports=o,t.exports.__esModule=!0,t.exports.default=t.exports},357:(t,o,e)=>{var n=e(648)();t.exports=n;try{regeneratorRuntime=n}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}}},o={};function e(n){var r=o[n];if(void 0!==r)return r.exports;var a=o[n]={exports:{}};return t[n](a,a.exports,e),a.exports}e.n=t=>{var o=t&&t.__esModule?()=>t.default:()=>t;return e.d(o,{a:o}),o},e.d=(t,o)=>{for(var n in o)e.o(o,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:o[n]})},e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),e.o=(t,o)=>Object.prototype.hasOwnProperty.call(t,o),e.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};(()=>{"use strict";function t(o,e){return t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,o){return t.__proto__=o,t},t(o,e)}function o(o,e){o.prototype=Object.create(e.prototype),o.prototype.constructor=o,t(o,e)}e.r(n),e.d(n,{components:()=>Mt,helpers:()=>Tt,models:()=>c});const r=flarum.core.compat["common/Model"];var a=e.n(r);const i=flarum.core.compat["common/utils/mixin"];var s=function(t){function e(){return t.apply(this,arguments)||this}return o(e,t),e}(e.n(i)()(a(),{points:a().attribute("points"),name:a().attribute("name"),color:a().attribute("color")})),c={Rank:s};const u=flarum.core.compat["forum/app"];var l=e.n(u);const f=flarum.core.compat["common/models/Discussion"];var p=e.n(f);const d=flarum.core.compat["common/models/Post"];var v=e.n(d);const h=flarum.core.compat["common/models/User"];var y=e.n(h);const g=flarum.core.compat["common/helpers/avatar"];var b=e.n(g);const w=flarum.core.compat["common/components/Page"];var N=e.n(w);const x=flarum.core.compat["forum/components/IndexPage"];var L=e.n(x);const k=flarum.core.compat["common/components/Button"];var P=e.n(k);const V=flarum.core.compat["common/components/LoadingIndicator"];var _=e.n(V);const F=flarum.core.compat["common/helpers/listItems"];var O=e.n(F);const j=flarum.core.compat["common/helpers/username"];var I=e.n(j);const S=flarum.core.compat["common/components/Link"];var E=e.n(S);const G=flarum.core.compat["common/Component"];var R=e.n(G);const B=flarum.core.compat["common/helpers/icon"];var D=e.n(B),M=function(t){function e(){return t.apply(this,arguments)||this}return o(e,t),e.prototype.view=function(){var t=l().forum.attribute("fof-gamification.topimage"+this.attrs.place+"Url"),o=this.attrs.place;return t?m("img",{className:"rankings-mobile rankings-image rankings-"+o,src:t,alt:""}):m("td",{className:"rankings-mobile rankings-"+o},D()("fas fa-trophy"))},e}(R()),U=function(t){function e(){return t.apply(this,arguments)||this}o(e,t);var n=e.prototype;return n.oninit=function(o){t.prototype.oninit.call(this,o),l().forum.attribute("canViewRankingPage")||m.route.set("/"),this.loading=!0,this.users=[],this.refresh()},n.view=function(){var t,o=this;return t=this.loading?_().component():P().component({className:"Button",onclick:this.loadMore.bind(this)},l().translator.trans("core.forum.discussion_list.load_more_button")),m("div",{className:"IndexPage"},L().prototype.hero(),m("div",{className:"container"},m("div",{className:"sideNavContainer"},m("nav",{className:"IndexPage-nav sideNav"},m("ul",null,O()(L().prototype.sidebarItems().toArray()))),m("div",{className:"IndexPage-results sideNavOffset"},m("table",{class:"rankings"},m("tr",null,m("th",{className:"rankings-mobile"},l().translator.trans("fof-gamification.forum.ranking.rank")),m("th",null,l().translator.trans("fof-gamification.forum.ranking.name")),m("th",null,l().translator.trans("fof-gamification.forum.ranking.amount"))),this.users.map((function(t,e){return++e,[m("tr",{className:"ranking-"+e},e<4?m(M,{place:e}):m("td",{className:"rankings-4 rankings-mobile"},o.addOrdinalSuffix(e)),m("td",null,m("div",{className:"PostUser"},m("h3",{className:"PostUser-name rankings-info"},m(E(),{href:l().route.user(t),force:!0},e<4?b()(t,{className:"info-avatar rankings-"+e+"-avatar"}):""," ",I()(t))))),e<4?m("td",{className:"rankings-"+e},t.points()):m("td",{className:"rankings-4"},t.points()))]}))),m("div",{className:"rankings-loadmore"}," ",t)))))},n.refresh=function(t){var o=this;return void 0===t&&(t=!0),t&&(this.loading=!0,this.users=[]),this.loadResults().then((function(t){o.users=[],o.parseResults(t)}),(function(){o.loading=!1,m.redraw()}))},n.addOrdinalSuffix=function(t){if("en"===l().data.locale){var o=t%10,e=t%100;return 1===o&&11!==e?t+"st":2===o&&12!==e?t+"nd":3===o&&13!==e?t+"rd":t+"th"}return t},n.loadResults=function(t){var o={};return o.page={offset:t,limit:"10"},l().store.find("rankings",o)},n.loadMore=function(){this.loading=!0,this.loadResults(this.users.length).then(this.parseResults.bind(this))},n.parseResults=function(t){return[].push.apply(this.users,t),this.loading=!1,this.users.sort((function(t,o){return parseFloat(o.points())-parseFloat(t.points())})),m.redraw(),t},e}(N());const T=flarum.core.compat["common/extend"],A=flarum.core.compat["forum/states/DiscussionListState"];var C=e.n(A);const H=flarum.core.compat["common/components/LinkButton"];var $=e.n(H);const z=flarum.core.compat["forum/components/CommentPost"];var W=e.n(z);const Y=flarum.core.compat["common/utils/classList"];var q=e.n(Y);const J=flarum.core.compat["forum/utils/PostControls"];var K=e.n(J);const Q=flarum.core.compat["common/components/Modal"];var X=function(t){function e(){return t.apply(this,arguments)||this}o(e,t);var n=e.prototype;return n.className=function(){return"VotesModal Modal--small"},n.title=function(){return l().translator.trans("fof-gamification.forum.modal.title")},n.oninit=function(o){t.prototype.oninit.call(this,o),this.loading=!this.attrs.post.upvotes()||!this.attrs.post.downvotes(),this.loading&&this.load()},n.content=function(){var t=this;return this.loading?m("div",{className:"Modal-body"},m(_(),null)):m("div",{className:"Modal-body"},m("ul",{className:"VotesModal-list"},["upvotes","downvotes"].map((function(o){var e=t.attrs.post[o]();if(e&&e.length)return m("div",null,m("legend",null,l().translator.trans("fof-gamification.forum.modal."+o+"_label")),e.map((function(t){return m("li",null,m(E(),{href:l().route.user(t)},b()(t)," ",I()(t)))})))}))))},n.load=function(){return l().store.find("posts",this.attrs.post.id(),{include:"upvotes,downvotes"}).then(this.loaded.bind(this))},e}(e.n(Q)());const Z=function(t,o){void 0===o&&(o=!1);var e=l().data["fof-gamification."+t];return o?!!parseInt(e):e},tt=flarum.core.compat["forum/utils/DiscussionControls"];var ot=e.n(tt);const et=function(t,o,e,n,r){if(void 0===r&&(r=t.discussion()),l().session.user){if(!r||r.canVote()||t.canVote())return o&&e&&(o=!1,e=!1),n&&n(!0),m.redraw(),t.save([o,e,"vote"]).then((function(){return null}),(function(){return null})).then((function(){n&&n(!1),r&&r.pushAttributes({votes:t.votes()}),m.redraw()}))}else ot().replyAction.call(r,!0)},nt=flarum.core.compat["forum/components/DiscussionListItem"];var rt=e.n(nt);const at=flarum.core.compat["common/utils/abbreviateNumber"];var it=e.n(at);const st=flarum.core.compat["forum/components/PostUser"];var ct=e.n(st);const ut=flarum.core.compat["forum/components/UserCard"];var lt=e.n(ut);function ft(t,o){void 0===o&&(o={}),o.style=o.style||{},o.className="rankLabel "+(o.className||"");var e=t.color();return o.style.backgroundColor=o.style.color=e,o.className+=" colored",m("span",o,m("span",{className:"rankLabel-text"},t.name()))}function mt(){var t=function(t){return function(o){return o&&o.attrs&&o.attrs.className&&String(o.attrs.className).split(" ").includes(t)}},o=function o(e,n){var r=[];if(e&&e.children&&Array.isArray(e.children)){var a=e.children.find(t(n));a&&r.push(a),e.children.forEach((function(t){r.push.apply(r,o(t,n))}))}return r};(0,T.extend)(lt().prototype,"infoItems",(function(t){var o=this.attrs.user;t.add("points",m("div",null,D()("fas fa-medal"),l().translator.trans("fof-gamification.forum.user.card.points",{count:o.points()})),50)})),(0,T.extend)(lt().prototype,"view",(function(e){var n=this.attrs.user,r=o(e,"UserCard-profile")[0],a=Number(Z("rankAmt"));if(r){var i=r.children.find(t("UserCard-badges"));return n.ranks()&&(i?n.ranks().reverse().map((function(t,o){if(!a||o<a)return m("li",{className:"User-Rank"},ft(t))})).forEach((function(t){t&&i.children.push(t)})):r.children.splice(1,0,m("ul",{className:"UserCard-badges badges"},n.ranks().reverse().map((function(t,o){if(!a||o<a)return m("li",{className:"User-Rank"},ft(t))}))))),e}})),(0,T.extend)(ct().prototype,"view",(function(o){var e,n=this.attrs.post.user();if(!n)return o;var r=o.children.find(t("PostUser-name")),a=null!=(e=Number(Z("rankAmt")))?e:n.ranks().length;r.children=r.children.concat(n.ranks().reverse().splice(0,a).map((function(t){return m("span",{className:"Post-Rank"},ft(t))}))).filter((function(t){return void 0!==t.tag}))}))}const pt=flarum.core.compat["forum/components/DiscussionPage"];var dt=e.n(pt),vt=e(987),ht=e.n(vt),yt=function(t){return l().store.find("posts",t).then((function(){return m.redraw()}))},gt=[];var bt=function(t,o){var e=t.firstPost();return e&&void 0!==e[o]()?e[o]():t[o]()};const wt=flarum.core.compat["common/states/DiscussionListState"];var Nt=e.n(wt);const xt=flarum.core.compat["forum/components/Notification"];var Lt=function(t){function e(){return t.apply(this,arguments)||this}o(e,t);var n=e.prototype;return n.icon=function(){var t=Z("iconName")||"thumbs";return this.attrs.notification.content()>0?"fas fa-"+t+"-up":"fas fa-"+t+"-down"},n.href=function(){return l().route.post(this.attrs.notification.subject())},n.content=function(){var t=this.attrs.notification.fromUser();return parseInt(this.attrs.notification.content())>0?l().translator.trans("fof-gamification.forum.notification.upvote",{user:t}):l().translator.trans("fof-gamification.forum.notification.downvote",{user:t})},n.excerpt=function(){return this.attrs.notification.subject().contentPlain()},e}(e.n(xt)());const kt=flarum.core.compat["forum/components/NotificationGrid"];var Pt=e.n(kt);function Vt(t,o,e,n,r,a,i){try{var s=t[a](i),c=s.value}catch(t){return void e(t)}s.done?o(c):Promise.resolve(c).then(n,r)}var _t=e(357),Ft=e.n(_t);const Ot=flarum.core.compat["common/components/Tooltip"];var jt=e.n(Ot);const It=flarum.core.compat["common/utils/SubtreeRetainer"];var St=e.n(It),Et=function(t){function e(){for(var o,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(o=t.call.apply(t,[this].concat(n))||this).subtreeRetainer=void 0,o.lastRenderVotes=-1,o.loading=!1,o}o(e,t);var n=e.prototype;return n.oninit=function(o){var e=this;t.prototype.oninit.call(this,o),this.loading=!this.attrs.post.upvotes(),this.loading&&this.load(),this.subtreeRetainer=new(St())((function(){return e.loading}),(function(){return e.attrs.post.votes()}),(function(){var t,o;return null==(t=e.attrs.post)||null==t.upvotes||null==(o=t.upvotes())?void 0:o.length}))},n.onbeforeupdate=function(o){return t.prototype.onbeforeupdate.call(this,o),this.subtreeRetainer.needsRebuild()},n.onupdate=function(t){this.lastRenderVotes!==this.attrs.post.votes()&&(this.loading=!0,setTimeout((function(){return m.redraw()}),0),this.lastRenderVotes=this.attrs.post.votes(),this.load())},n.view=function(){if(!1===this.attrs.post.votes()||!1===this.attrs.post.upvotes())return m("div",{className:"VotingContainer"},m("div",{className:"FoFGamification-voters"},m("div",{className:"FoFGamification-voters-title"},m("span",{className:"FoFGamification-voters-title-icon"},D()("fas fa-users"),m("span",{className:"FoFGamification-voters-title-label"},l().translator.trans("fof-gamification.forum.voters.label")),m("span",{className:"FoFGamification-voters-title-label FoFGamification-voters-title-label--mobile"},l().translator.trans("fof-gamification.forum.voters.label")))),m(_(),{display:"inline"})));var t=this.attrs.post.upvotes();return m("div",{className:"VotingContainer"},m("div",{className:"FoFGamification-voters"},m("div",{className:"FoFGamification-voters-title"},m("span",{className:"FoFGamification-voters-title-icon"},D()("fas fa-users"),m("span",{className:"FoFGamification-voters-title-label"},l().translator.trans("fof-gamification.forum.voters.label")),m("span",{className:"FoFGamification-voters-title-label FoFGamification-voters-title-label--mobile"},0===t.length?l().translator.trans("fof-gamification.forum.voters.label_none"):l().translator.trans("fof-gamification.forum.voters.label")))),m("div",{className:"FoFGamification-voters-message"},0===t.length?l().translator.trans("fof-gamification.forum.voters.none"):null),m("div",{className:"FoFGamification-voters-list"},t.slice(0,15).map((function(t){return m(E(),{href:l().route("user",{username:t.slug()}),className:"FoFGamification-voters-item"},m(jt(),{text:t.displayName()},b()(t)))})),t.length>15?m("span",{className:"FoFGamification-voters-item FoFGamification-voters-item--plus"},m("span",{className:"Avatar"},"+"+(t.length-15))):null)))},n.load=function(){var t,o=(t=Ft().mark((function t(){return Ft().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l().store.find("posts",this.attrs.post.id(),{include:"upvotes"});case 2:this.loading=!1,m.redraw();case 4:case"end":return t.stop()}}),t,this)})),function(){var o=this,e=arguments;return new Promise((function(n,r){var a=t.apply(o,e);function i(t){Vt(a,n,r,i,s,"next",t)}function s(t){Vt(a,n,r,i,s,"throw",t)}i(void 0)}))});return function(){return o.apply(this,arguments)}}(),e}(R());const Gt=flarum.core.compat["forum/components/UserPage"];var Rt=e.n(Gt);const Bt=flarum.core.compat["forum/components/PostsUserPage"];var Dt=function(t){function e(){return t.apply(this,arguments)||this}return o(e,t),e.prototype.loadResults=function(t){return l().store.find("posts",{filter:{type:"comment",voted:this.user.id()},page:{offset:t,limit:this.loadLimit},sort:"-createdAt"})},e}(e.n(Bt)()),Mt={RankingsPage:U,VoteNotification:Lt,VotesModal:X,Voters:Et};function Ut(){return Ut=Object.assign?Object.assign.bind():function(t){for(var o=1;o<arguments.length;o++){var e=arguments[o];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},Ut.apply(this,arguments)}var Tt=Ut({saveVote:et,setting:Z},{rankLabel:ft});l().initializers.add("fof-gamification",(function(){p().prototype.votes=a().attribute("votes"),p().prototype.hasUpvoted=a().attribute("hasUpvoted"),p().prototype.hasDownvoted=a().attribute("hasDownvoted"),p().prototype.canVote=a().attribute("canVote"),p().prototype.seeVotes=a().attribute("seeVotes"),y().prototype.points=a().attribute("points"),y().prototype.ranks=a().hasMany("ranks"),y().prototype.canHaveVotingNotifications=a().attribute("canHaveVotingNotifications"),v().prototype.upvotes=a().hasMany("upvotes"),v().prototype.downvotes=a().hasMany("downvotes"),v().prototype.votes=a().attribute("votes"),v().prototype.canVote=a().attribute("canVote"),v().prototype.canSeeVotes=a().attribute("canSeeVotes"),v().prototype.hasUpvoted=a().attribute("hasUpvoted"),v().prototype.hasDownvoted=a().attribute("hasDownvoted"),v().prototype.seeVoters=a().attribute("seeVoters"),l().store.models.ranks=s,l().routes.rankings={path:"/rankings",component:U},(0,T.extend)(K(),"moderationControls",(function(t,o){o.seeVoters()&&t.add("viewVotes",[m(P(),{icon:"fas fa-thumbs-up",onclick:function(){l().modal.show(X,{post:o})}},l().translator.trans("fof-gamification.forum.mod_item"))])})),(0,T.extend)(W().prototype,"actionItems",(function(t){var o=this,e=this.attrs.post,n=e.hasDownvoted(),r=e.hasUpvoted(),a=Z("iconName")||"thumbs",i=Z("upVotesOnly",!0),s=e.canSeeVotes(),c=!l().session.user||e.canVote(),u=function(t,n){return et(e,t,n,(function(t){return o.voteLoading=t}))};t.add("votes",m("div",{className:q()("CommentPost-votes",Z("useAlternateLayout",!0)&&"alternateLayout")},P().component({icon:this.voteLoading?void 0:"fas fa-fw fa-"+a+"-up",className:q()("Post-vote Post-upvote",r&&"Post-vote--active"),loading:this.voteLoading,disabled:this.voteLoading||!c||!s,onclick:function(){return u(!r,!1)},"aria-label":l().translator.trans("fof-gamification.forum.post.upvote_button")}),m("label",{className:"Post-points"},e.votes()),!i&&P().component({icon:this.voteLoading?void 0:"fas fa-fw fa-"+a+"-down",className:q()("Post-vote Post-downvote",n&&"Post-vote--active"),loading:this.voteLoading,disabled:!c||!s,onclick:function(){return u(!1,!n)},"aria-label":l().translator.trans("fof-gamification.forum.post.downvote_button")})),10)})),(0,T.extend)(L().prototype,"navItems",(function(t){l().forum.attribute("canViewRankingPage")&&t.add("rankings",$().component({href:l().route("rankings"),icon:"fas fa-trophy"},l().translator.trans("fof-gamification.forum.nav.name")),80)})),(0,T.extend)(C().prototype,"sortMap",(function(t){t.hot="-hotness"})),(0,T.extend)(Nt().prototype,"sortMap",(function(t){t.votes="-votes"})),mt(),Z("showVotesOnDiscussionPage",!0)&&!Z("useAlternateLayout",!0)&&((0,T.extend)(rt().prototype,"elementAttrs",(function(t){this.attrs.discussion.seeVotes()&&(t.className+=" DiscussionListItem--withVotes")})),(0,T.extend)(rt().prototype,"infoItems",(function(t){this.attrs.discussion.seeVotes()&&t.add("discussion-votes",m("span",{className:"DiscussionListItem-votes",title:l().translator.trans("fof-gamification.forum.votes")},D()("far fa-thumbs-up"),it()(this.attrs.discussion.votes())),20)}))),(0,T.extend)(dt().prototype,"oncreate",(function(){l().pusher&&l().pusher.then((function(t){t.pusher.bind("newVote",(function(t){var o,e,n=l().store.getById("posts",t.post_id),r=t.user_id;n&&n.votes()!==t.votes&&r!=l().session.user.id()&&(o=n.id(),(e=gt[o])?e(o):(e=gt[o]=ht()(yt,1500))(o))}))}))})),(0,T.extend)(dt().prototype,"onremove",(function(){l().pusher&&l().pusher.then((function(t){t.pusher.unbind("newVote")}))})),l().notificationComponents.vote=Lt,(0,T.extend)(Pt().prototype,"notificationTypes",(function(t){var o,e=null==(o=l().session)?void 0:o.user;null!=e&&null!=e.canHaveVotingNotifications&&e.canHaveVotingNotifications()&&t.add("vote",{name:"vote",icon:"fas fa-thumbs-up",label:l().translator.trans("fof-gamification.forum.notification.prefrences.vote")})})),(0,T.extend)(dt().prototype,"sidebarItems",(function(t){var o=this.discussion.posts()||[],e=null==o?void 0:o[0];null!=e&&null!=e.canSeeVotes&&e.canSeeVotes()&&null!=e&&null!=e.seeVoters&&e.seeVoters()&&l().forum.attribute("fof-gamification-op-votes-only")&&t.add("op-voters",m(Et,{post:e}),90)})),l().routes["user.votes"]={path:"/u/:username/votes",component:Dt},(0,T.extend)(Rt().prototype,"navItems",(function(t){var o=this.user,e=Z("iconName")||"thumbs";t.add("votes",m($(),{href:l().route("user.votes",{username:o.slug()}),name:"votes",icon:"fas fa-fw fa-"+e+"-up"},l().translator.trans("fof-gamification.forum.user.votes_link")),85)})),Z("useAlternateLayout",!0)&&((0,T.extend)(rt().prototype,"oninit",(function(){var t=this;this.attrs.discussion.seeVotes()&&this.subtree.check((function(){return t.voteLoading}))})),(0,T.extend)(rt().prototype,"view",(function(t){var o=this,e=this.attrs.discussion;if(e.seeVotes()&&t&&t.children){var n=t.children.find((function(t){return t&&t.attrs&&t.attrs.className&&t.attrs.className.includes("DiscussionListItem-content")})),r=e.firstPost(),a=bt(e,"hasUpvoted"),i=bt(e,"hasDownvoted"),s=!l().session.user||bt(e,"canVote"),c=Z("upVotesOnly",!0),u=Z("iconNameAlt")||"arrow",f=function(t,e){return et(r,t,e,(function(t){return o.voteLoading=t}))};n.children.unshift(m("div",{className:"DiscussionListItem-votes alternateLayout","data-upvotes-only":c},m(P(),{className:"DiscussionListItem-voteButton DiscussionListItem-voteButton--up Button Button--icon Button--text",icon:"fas fa-fw fa-"+u+"-up","data-active":a,disabled:!s||this.voteLoading,onclick:function(){return f(!a,!1)},"aria-label":l().translator.trans("fof-gamification.forum.post.upvote_button")}),m("span",{class:"DiscussionListItem-voteCount"},it()(bt(e,"votes")||0)),!c&&m(P(),{className:"DiscussionListItem-voteButton DiscussionListItem-voteButton--down Button Button--icon Button--text",icon:"fas fa-fw fa-"+u+"-down","data-active":i,disabled:!s||this.voteLoading,onclick:function(){return f(!1,!i)},"aria-label":l().translator.trans("fof-gamification.forum.post.downvote_button")}),this.voteLoading&&m(_(),{display:"inline",size:"small"})))}}))),Z("altPostVotingUi",!0)&&((0,T.extend)(W().prototype,"actionItems",(function(t){this.attrs.post.isHidden()||t.remove("votes")})),(0,T.extend)(W().prototype,"classes",(function(t){if(!this.attrs.post.isHidden()){var o=Z("upVotesOnly",!0);t.push("votesAlternativeLayout"),o&&t.push("votesUpvotesOnly")}})),(0,T.extend)(W().prototype,"headerItems",(function(t){var o=this,e=this.attrs.post;if(!e.isHidden()&&e.canSeeVotes()){var n=e.hasDownvoted(),r=e.hasUpvoted(),a=Z("iconName")||"thumbs",i=Z("upVotesOnly",!0),s=e.canSeeVotes(),c=!l().session.user||e.canVote(),u=function(t,n){return et(e,t,n,(function(t){o.voteLoading=t}))};t.add("votes",m("div",{className:"Post-votes alternateLayout","data-upvotes-only":i},m(P(),{className:"Post-voteButton Post-voteButton--up Button Button--icon Button--text",icon:"fas fa-fw fa-"+a+"-up","data-active":r,disabled:!c||this.voteLoading||!s,onclick:function(){return u(!r,!1)},"aria-label":l().translator.trans("fof-gamification.forum.post.upvote_button")}),m("span",{class:"Post-voteCount"},it()(e.votes()||0)),!i&&m(P(),{className:"Post-voteButton Post-voteButton--down Button Button--icon Button--text",icon:"fas fa-fw fa-"+a+"-down","data-active":n,disabled:!c||this.voteLoading,onclick:function(){return u(!1,!n)},"aria-label":l().translator.trans("fof-gamification.forum.post.downvote_button")}),this.voteLoading&&m(_(),{display:"inline",size:"small"})),1e4)}})))}))})(),module.exports=n})();
//# sourceMappingURL=forum.js.map