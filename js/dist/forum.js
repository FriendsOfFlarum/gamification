/*! For license information please see forum.js.LICENSE.txt */
(()=>{var t={976:(t,o,n)=>{var e=/^\s+|\s+$/g,r=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,i=/^0o[0-7]+$/i,s=parseInt,c="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,u="object"==typeof self&&self&&self.Object===Object&&self,l=c||u||Function("return this")(),f=Object.prototype.toString,m=Math.max,p=Math.min,d=function(){return l.Date.now()};function v(t){var o=typeof t;return!!t&&("object"==o||"function"==o)}function h(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&"[object Symbol]"==f.call(t)}(t))return NaN;if(v(t)){var o="function"==typeof t.valueOf?t.valueOf():t;t=v(o)?o+"":o}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(e,"");var n=a.test(t);return n||i.test(t)?s(t.slice(2),n?2:8):r.test(t)?NaN:+t}t.exports=function(t,o,n){var e,r,a,i,s,c,u=0,l=!1,f=!1,g=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function y(o){var n=e,a=r;return e=r=void 0,u=o,i=t.apply(a,n)}function b(t){var n=t-c;return void 0===c||n>=o||n<0||f&&t-u>=a}function w(){var t=d();if(b(t))return N(t);s=setTimeout(w,function(t){var n=o-(t-c);return f?p(n,a-(t-u)):n}(t))}function N(t){return s=void 0,g&&e?y(t):(e=r=void 0,i)}function x(){var t=d(),n=b(t);if(e=arguments,r=this,c=t,n){if(void 0===s)return function(t){return u=t,s=setTimeout(w,o),l?y(t):i}(c);if(f)return s=setTimeout(w,o),y(c)}return void 0===s&&(s=setTimeout(w,o)),i}return o=h(o)||0,v(n)&&(l=!!n.leading,a=(f="maxWait"in n)?m(h(n.maxWait)||0,o):a,g="trailing"in n?!!n.trailing:g),x.cancel=function(){void 0!==s&&clearTimeout(s),u=0,e=c=r=s=void 0},x.flush=function(){return void 0===s?i:N(d())},x}},24:(t,o,n)=>{var e=n(116).default;function r(){"use strict";t.exports=r=function(){return n},t.exports.__esModule=!0,t.exports.default=t.exports;var o,n={},a=Object.prototype,i=a.hasOwnProperty,s=Object.defineProperty||function(t,o,n){t[o]=n.value},c="function"==typeof Symbol?Symbol:{},u=c.iterator||"@@iterator",l=c.asyncIterator||"@@asyncIterator",f=c.toStringTag||"@@toStringTag";function m(t,o,n){return Object.defineProperty(t,o,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[o]}try{m({},"")}catch(o){m=function(t,o,n){return t[o]=n}}function p(t,o,n,e){var r=o&&o.prototype instanceof w?o:w,a=Object.create(r.prototype),i=new E(e||[]);return s(a,"_invoke",{value:O(t,n,i)}),a}function d(t,o,n){try{return{type:"normal",arg:t.call(o,n)}}catch(t){return{type:"throw",arg:t}}}n.wrap=p;var v="suspendedStart",h="suspendedYield",g="executing",y="completed",b={};function w(){}function N(){}function x(){}var L={};m(L,u,(function(){return this}));var k=Object.getPrototypeOf,P=k&&k(k(M([])));P&&P!==a&&i.call(P,u)&&(L=P);var V=x.prototype=w.prototype=Object.create(L);function _(t){["next","throw","return"].forEach((function(o){m(t,o,(function(t){return this._invoke(o,t)}))}))}function F(t,o){function n(r,a,s,c){var u=d(t[r],t,a);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==e(f)&&i.call(f,"__await")?o.resolve(f.__await).then((function(t){n("next",t,s,c)}),(function(t){n("throw",t,s,c)})):o.resolve(f).then((function(t){l.value=t,s(l)}),(function(t){return n("throw",t,s,c)}))}c(u.arg)}var r;s(this,"_invoke",{value:function(t,e){function a(){return new o((function(o,r){n(t,e,o,r)}))}return r=r?r.then(a,a):a()}})}function O(t,n,e){var r=v;return function(a,i){if(r===g)throw Error("Generator is already running");if(r===y){if("throw"===a)throw i;return{value:o,done:!0}}for(e.method=a,e.arg=i;;){var s=e.delegate;if(s){var c=j(s,e);if(c){if(c===b)continue;return c}}if("next"===e.method)e.sent=e._sent=e.arg;else if("throw"===e.method){if(r===v)throw r=y,e.arg;e.dispatchException(e.arg)}else"return"===e.method&&e.abrupt("return",e.arg);r=g;var u=d(t,n,e);if("normal"===u.type){if(r=e.done?y:h,u.arg===b)continue;return{value:u.arg,done:e.done}}"throw"===u.type&&(r=y,e.method="throw",e.arg=u.arg)}}}function j(t,n){var e=n.method,r=t.iterator[e];if(r===o)return n.delegate=null,"throw"===e&&t.iterator.return&&(n.method="return",n.arg=o,j(t,n),"throw"===n.method)||"return"!==e&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+e+"' method")),b;var a=d(r,t.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,b;var i=a.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=o),n.delegate=null,b):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,b)}function I(t){var o={tryLoc:t[0]};1 in t&&(o.catchLoc=t[1]),2 in t&&(o.finallyLoc=t[2],o.afterLoc=t[3]),this.tryEntries.push(o)}function S(t){var o=t.completion||{};o.type="normal",delete o.arg,t.completion=o}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(I,this),this.reset(!0)}function M(t){if(t||""===t){var n=t[u];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,a=function n(){for(;++r<t.length;)if(i.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=o,n.done=!0,n};return a.next=a}}throw new TypeError(e(t)+" is not iterable")}return N.prototype=x,s(V,"constructor",{value:x,configurable:!0}),s(x,"constructor",{value:N,configurable:!0}),N.displayName=m(x,f,"GeneratorFunction"),n.isGeneratorFunction=function(t){var o="function"==typeof t&&t.constructor;return!!o&&(o===N||"GeneratorFunction"===(o.displayName||o.name))},n.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,m(t,f,"GeneratorFunction")),t.prototype=Object.create(V),t},n.awrap=function(t){return{__await:t}},_(F.prototype),m(F.prototype,l,(function(){return this})),n.AsyncIterator=F,n.async=function(t,o,e,r,a){void 0===a&&(a=Promise);var i=new F(p(t,o,e,r),a);return n.isGeneratorFunction(o)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},_(V),m(V,f,"Generator"),m(V,u,(function(){return this})),m(V,"toString",(function(){return"[object Generator]"})),n.keys=function(t){var o=Object(t),n=[];for(var e in o)n.push(e);return n.reverse(),function t(){for(;n.length;){var e=n.pop();if(e in o)return t.value=e,t.done=!1,t}return t.done=!0,t}},n.values=M,E.prototype={constructor:E,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=o,this.done=!1,this.delegate=null,this.method="next",this.arg=o,this.tryEntries.forEach(S),!t)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=o)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function e(e,r){return s.type="throw",s.arg=t,n.next=e,r&&(n.method="next",n.arg=o),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r],s=a.completion;if("root"===a.tryLoc)return e("end");if(a.tryLoc<=this.prev){var c=i.call(a,"catchLoc"),u=i.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return e(a.catchLoc,!0);if(this.prev<a.finallyLoc)return e(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return e(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return e(a.finallyLoc)}}}},abrupt:function(t,o){for(var n=this.tryEntries.length-1;n>=0;--n){var e=this.tryEntries[n];if(e.tryLoc<=this.prev&&i.call(e,"finallyLoc")&&this.prev<e.finallyLoc){var r=e;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=o&&o<=r.finallyLoc&&(r=null);var a=r?r.completion:{};return a.type=t,a.arg=o,r?(this.method="next",this.next=r.finallyLoc,b):this.complete(a)},complete:function(t,o){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&o&&(this.next=o),b},finish:function(t){for(var o=this.tryEntries.length-1;o>=0;--o){var n=this.tryEntries[o];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),S(n),b}},catch:function(t){for(var o=this.tryEntries.length-1;o>=0;--o){var n=this.tryEntries[o];if(n.tryLoc===t){var e=n.completion;if("throw"===e.type){var r=e.arg;S(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(t,n,e){return this.delegate={iterator:M(t),resultName:n,nextLoc:e},"next"===this.method&&(this.arg=o),b}},n}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports},116:t=>{function o(n){return t.exports=o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,o(n)}t.exports=o,t.exports.__esModule=!0,t.exports.default=t.exports},183:(t,o,n)=>{var e=n(24)();t.exports=e;try{regeneratorRuntime=e}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}}},o={};function n(e){var r=o[e];if(void 0!==r)return r.exports;var a=o[e]={exports:{}};return t[e](a,a.exports,n),a.exports}n.n=t=>{var o=t&&t.__esModule?()=>t.default:()=>t;return n.d(o,{a:o}),o},n.d=(t,o)=>{for(var e in o)n.o(o,e)&&!n.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:o[e]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,o)=>Object.prototype.hasOwnProperty.call(t,o),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var e={};(()=>{"use strict";function t(o,n){return t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,o){return t.__proto__=o,t},t(o,n)}function o(o,n){o.prototype=Object.create(n.prototype),o.prototype.constructor=o,t(o,n)}n.r(e),n.d(e,{components:()=>At,extend:()=>Tt,helpers:()=>Ht,models:()=>s});const r=flarum.core.compat["common/Model"];var a=n.n(r),i=function(t){function n(){return t.apply(this,arguments)||this}o(n,t);var e=n.prototype;return e.points=function(){return a().attribute("points").call(this)},e.name=function(){return a().attribute("name").call(this)},e.color=function(){return a().attribute("color").call(this)},n}(a()),s={Rank:i};const c=flarum.core.compat["forum/app"];var u=n.n(c);const l=flarum.core.compat["common/extend"],f=flarum.core.compat["forum/components/IndexPage"];var p=n.n(f);const d=flarum.core.compat["forum/states/DiscussionListState"];var v=n.n(d);const h=flarum.core.compat["common/components/LinkButton"];var g=n.n(h);const y=flarum.core.compat["common/components/Button"];var b=n.n(y);const w=flarum.core.compat["forum/components/CommentPost"];var N=n.n(w);const x=flarum.core.compat["common/utils/classList"];var L=n.n(x);const k=flarum.core.compat["forum/utils/PostControls"];var P=n.n(k);const V=flarum.core.compat["common/components/Modal"];var _=n.n(V);const F=flarum.core.compat["common/components/LoadingIndicator"];var O=n.n(F);const j=flarum.core.compat["common/helpers/avatar"];var I=n.n(j);const S=flarum.core.compat["common/helpers/username"];var E=n.n(S);const M=flarum.core.compat["common/components/Link"];var G=n.n(M),R=function(t){function n(){return t.apply(this,arguments)||this}o(n,t);var e=n.prototype;return e.className=function(){return"VotesModal Modal--small"},e.title=function(){return u().translator.trans("fof-gamification.forum.modal.title")},e.oninit=function(o){t.prototype.oninit.call(this,o),this.loading=!this.attrs.post.upvotes()||!this.attrs.post.downvotes(),this.loading&&this.load()},e.content=function(){var t=this;return this.loading?m("div",{className:"Modal-body"},m(O(),null)):m("div",{className:"Modal-body"},m("ul",{className:"VotesModal-list"},["upvotes","downvotes"].map((function(o){var n=t.attrs.post[o]();if(n&&n.length)return m("div",null,m("legend",null,u().translator.trans("fof-gamification.forum.modal."+o+"_label")),n.map((function(t){return m("li",null,m(G(),{href:u().route.user(t)},I()(t)," ",E()(t)))})))}))))},e.load=function(){return u().store.find("posts",this.attrs.post.id(),{include:"upvotes,downvotes"}).then(this.loaded.bind(this))},n}(_());const B=function(t,o){void 0===o&&(o=!1);var n=u().data["fof-gamification."+t];return o?!!parseInt(n):n},D=flarum.core.compat["forum/utils/DiscussionControls"];var U=n.n(D);const T=function(t,o,n,e,r){if(void 0===r&&(r=t.discussion()),u().session.user){if(!r||r.canVote()||t.canVote())return o&&n&&(o=!1,n=!1),e&&e(!0),m.redraw(),t.save([o,n,"vote"]).then((function(){return null}),(function(){return null})).then((function(){e&&e(!1),r&&r.pushAttributes({votes:t.votes()}),m.redraw()}))}else U().replyAction.call(r,!0)},A=flarum.core.compat["forum/components/DiscussionListItem"];var C=n.n(A);const H=flarum.core.compat["common/utils/abbreviateNumber"];var $=n.n(H);const z=flarum.core.compat["common/helpers/icon"];var W=n.n(z);const Y=flarum.core.compat["forum/components/PostUser"];var q=n.n(Y);const J=flarum.core.compat["forum/components/UserCard"];var K=n.n(J);function Q(t,o){void 0===o&&(o={}),o.style=o.style||{},o.className="rankLabel "+(o.className||"");var n=t.color();return o.style.backgroundColor=o.style.color=n,o.className+=" colored",m("span",o,m("span",{className:"rankLabel-text"},t.name()))}const X=flarum.core.compat["forum/components/DiscussionPage"];var Z=n.n(X),tt=n(976),ot=n.n(tt),nt=function(t){return u().store.find("posts",t).then((function(){return m.redraw()}))},et=[];var rt=function(t,o){var n=t.firstPost();return n&&void 0!==n[o]()?n[o]():t[o]()};const at=flarum.core.compat["common/states/DiscussionListState"];var it=n.n(at);const st=flarum.core.compat["forum/components/Notification"];var ct=function(t){function n(){return t.apply(this,arguments)||this}o(n,t);var e=n.prototype;return e.icon=function(){var t=B("iconName")||"thumbs";return this.attrs.notification.content()>0?"fas fa-"+t+"-up":"fas fa-"+t+"-down"},e.href=function(){return u().route.post(this.attrs.notification.subject())},e.content=function(){var t=this.attrs.notification.fromUser();return parseInt(this.attrs.notification.content())>0?u().translator.trans("fof-gamification.forum.notification.upvote",{user:t}):u().translator.trans("fof-gamification.forum.notification.downvote",{user:t})},e.excerpt=function(){return this.attrs.notification.subject().contentPlain()},n}(n.n(st)());const ut=flarum.core.compat["forum/components/NotificationGrid"];var lt=n.n(ut);function ft(t,o,n,e,r,a,i){try{var s=t[a](i),c=s.value}catch(t){return void n(t)}s.done?o(c):Promise.resolve(c).then(e,r)}var mt=n(183),pt=n.n(mt);const dt=flarum.core.compat["common/Component"];var vt=n.n(dt);const ht=flarum.core.compat["common/components/Tooltip"];var gt=n.n(ht);const yt=flarum.core.compat["common/utils/SubtreeRetainer"];var bt=n.n(yt),wt=function(t){function n(){for(var o,n=arguments.length,e=new Array(n),r=0;r<n;r++)e[r]=arguments[r];return(o=t.call.apply(t,[this].concat(e))||this).subtreeRetainer=void 0,o.lastRenderVotes=-1,o.loading=!1,o}o(n,t);var e=n.prototype;return e.oninit=function(o){var n=this;t.prototype.oninit.call(this,o),this.loading=!this.attrs.post.upvotes(),this.loading&&this.load(),this.subtreeRetainer=new(bt())((function(){return n.loading}),(function(){return n.attrs.post.votes()}),(function(){var t;return null==(t=n.attrs.post)||null==t.upvotes||null==(t=t.upvotes())?void 0:t.length}))},e.onbeforeupdate=function(o){return t.prototype.onbeforeupdate.call(this,o),this.subtreeRetainer.needsRebuild()},e.onupdate=function(t){this.lastRenderVotes!==this.attrs.post.votes()&&(this.loading=!0,setTimeout((function(){return m.redraw()}),0),this.lastRenderVotes=this.attrs.post.votes(),this.load())},e.view=function(){if(!1===this.attrs.post.votes()||!1===this.attrs.post.upvotes())return m("div",{className:"VotingContainer"},m("div",{className:"FoFGamification-voters"},m("div",{className:"FoFGamification-voters-title"},m("span",{className:"FoFGamification-voters-title-icon"},W()("fas fa-users"),m("span",{className:"FoFGamification-voters-title-label"},u().translator.trans("fof-gamification.forum.voters.label")),m("span",{className:"FoFGamification-voters-title-label FoFGamification-voters-title-label--mobile"},u().translator.trans("fof-gamification.forum.voters.label")))),m(O(),{display:"inline"})));var t=this.attrs.post.upvotes();return m("div",{className:"VotingContainer"},m("div",{className:"FoFGamification-voters"},m("div",{className:"FoFGamification-voters-title"},m("span",{className:"FoFGamification-voters-title-icon"},W()("fas fa-users"),m("span",{className:"FoFGamification-voters-title-label"},u().translator.trans("fof-gamification.forum.voters.label")),m("span",{className:"FoFGamification-voters-title-label FoFGamification-voters-title-label--mobile"},0===t.length?u().translator.trans("fof-gamification.forum.voters.label_none"):u().translator.trans("fof-gamification.forum.voters.label")))),m("div",{className:"FoFGamification-voters-message"},0===t.length?u().translator.trans("fof-gamification.forum.voters.none"):null),m("div",{className:"FoFGamification-voters-list"},t.slice(0,15).map((function(t){return m(G(),{href:u().route("user",{username:t.slug()}),className:"FoFGamification-voters-item"},m(gt(),{text:t.displayName()},I()(t)))})),t.length>15?m("span",{className:"FoFGamification-voters-item FoFGamification-voters-item--plus"},m("span",{className:"Avatar"},"+"+(t.length-15))):null)))},e.load=function(){var t,o=(t=pt().mark((function t(){return pt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u().store.find("posts",this.attrs.post.id(),{include:"upvotes"});case 2:this.loading=!1,m.redraw();case 4:case"end":return t.stop()}}),t,this)})),function(){var o=this,n=arguments;return new Promise((function(e,r){var a=t.apply(o,n);function i(t){ft(a,e,r,i,s,"next",t)}function s(t){ft(a,e,r,i,s,"throw",t)}i(void 0)}))});return function(){return o.apply(this,arguments)}}(),n}(vt());const Nt=flarum.core.compat["forum/components/UserPage"];var xt=n.n(Nt);const Lt=flarum.core.compat["forum/components/PostsUserPage"];var kt=function(t){function n(){return t.apply(this,arguments)||this}return o(n,t),n.prototype.loadResults=function(t){return u().store.find("posts",{filter:{type:"comment",voted:this.user.id()},page:{offset:t,limit:this.loadLimit},sort:"-createdAt"})},n}(n.n(Lt)());const Pt=flarum.core.compat["common/extenders"];var Vt=n.n(Pt);const _t=[(new(Vt().Store)).add("ranks",i)],Ft=flarum.core.compat["common/components/Page"];var Ot=n.n(Ft);const jt=flarum.core.compat["common/helpers/listItems"];var It=n.n(jt),St=function(t){function n(){return t.apply(this,arguments)||this}return o(n,t),n.prototype.view=function(){var t=u().forum.attribute("fof-gamification.topimage"+this.attrs.place+"Url"),o=this.attrs.place;return t?m("img",{className:"rankings-mobile rankings-image rankings-"+o,src:t,alt:""}):m("td",{className:"rankings-mobile rankings-"+o},W()("fas fa-trophy"))},n}(vt()),Et=function(t){function n(){return t.apply(this,arguments)||this}o(n,t);var e=n.prototype;return e.oninit=function(o){t.prototype.oninit.call(this,o),u().forum.attribute("canViewRankingPage")||m.route.set("/"),this.loading=!0,this.users=[],this.refresh()},e.view=function(){var t,o=this;return t=this.loading?O().component():b().component({className:"Button",onclick:this.loadMore.bind(this)},u().translator.trans("core.forum.discussion_list.load_more_button")),m("div",{className:"IndexPage"},p().prototype.hero(),m("div",{className:"container"},m("div",{className:"sideNavContainer"},m("nav",{className:"IndexPage-nav sideNav"},m("ul",null,It()(p().prototype.sidebarItems().toArray()))),m("div",{className:"IndexPage-results sideNavOffset"},m("table",{class:"rankings"},m("tr",null,m("th",{className:"rankings-mobile"},u().translator.trans("fof-gamification.forum.ranking.rank")),m("th",null,u().translator.trans("fof-gamification.forum.ranking.name")),m("th",null,u().translator.trans("fof-gamification.forum.ranking.amount"))),this.users.map((function(t,n){return++n,[m("tr",{className:"ranking-"+n},n<4?m(St,{place:n}):m("td",{className:"rankings-4 rankings-mobile"},o.addOrdinalSuffix(n)),m("td",null,m("div",{className:"PostUser"},m("h3",{className:"PostUser-name rankings-info"},m(G(),{href:u().route.user(t),force:!0},n<4?I()(t,{className:"info-avatar rankings-"+n+"-avatar"}):""," ",E()(t))))),n<4?m("td",{className:"rankings-"+n},t.points()):m("td",{className:"rankings-4"},t.points()))]}))),m("div",{className:"rankings-loadmore"}," ",t)))))},e.refresh=function(t){var o=this;return void 0===t&&(t=!0),t&&(this.loading=!0,this.users=[]),this.loadResults().then((function(t){o.users=[],o.parseResults(t)}),(function(){o.loading=!1,m.redraw()}))},e.addOrdinalSuffix=function(t){if("en"===u().data.locale){var o=t%10,n=t%100;return 1===o&&11!==n?t+"st":2===o&&12!==n?t+"nd":3===o&&13!==n?t+"rd":t+"th"}return t},e.loadResults=function(t){var o={};return o.page={offset:t,limit:"10"},u().store.find("rankings",o)},e.loadMore=function(){this.loading=!0,this.loadResults(this.users.length).then(this.parseResults.bind(this))},e.parseResults=function(t){return[].push.apply(this.users,t),this.loading=!1,this.users.sort((function(t,o){return parseFloat(o.points())-parseFloat(t.points())})),m.redraw(),t},n}(Ot());const Mt=flarum.core.compat["common/models/Discussion"];var Gt=n.n(Mt);const Rt=flarum.core.compat["common/models/Post"];var Bt=n.n(Rt);const Dt=flarum.core.compat["common/models/User"];var Ut=n.n(Dt);const Tt=[].concat(_t,[(new(Vt().Routes)).add("rankings","/rankings",Et),new(Vt().Model)(Gt()).attribute("votes").attribute("hasUpvoted").attribute("hasDownvoted").attribute("canVote").attribute("seeVotes"),new(Vt().Model)(Bt()).hasMany("upvotes").hasMany("downvotes").attribute("votes").attribute("canVote").attribute("canSeeVotes").attribute("hasUpvoted").attribute("hasDownvoted").attribute("seeVoters"),new(Vt().Model)(Ut()).attribute("points").hasMany("ranks").attribute("canHaveVotingNotifications")]);var At={RankingsPage:Et,VoteNotification:ct,VotesModal:R,Voters:wt};function Ct(){return Ct=Object.assign?Object.assign.bind():function(t){for(var o=1;o<arguments.length;o++){var n=arguments[o];for(var e in n)({}).hasOwnProperty.call(n,e)&&(t[e]=n[e])}return t},Ct.apply(null,arguments)}var Ht=Ct({saveVote:T,setting:B},{rankLabel:Q});u().initializers.add("fof-gamification",(function(){var t,o;(0,l.extend)(P(),"moderationControls",(function(t,o){o.seeVoters()&&t.add("viewVotes",[m(b(),{icon:"fas fa-thumbs-up",onclick:function(){u().modal.show(R,{post:o})}},u().translator.trans("fof-gamification.forum.mod_item"))])})),(0,l.extend)(N().prototype,"actionItems",(function(t){var o=this,n=this.attrs.post,e=n.hasDownvoted(),r=n.hasUpvoted(),a=B("iconName")||"thumbs",i=B("upVotesOnly",!0),s=n.canSeeVotes(),c=!u().session.user||n.canVote(),l=function(t,e){return T(n,t,e,(function(t){return o.voteLoading=t}))};t.add("votes",m("div",{className:L()("CommentPost-votes",B("useAlternateLayout",!0)&&"alternateLayout")},b().component({icon:this.voteLoading?void 0:"fas fa-fw fa-"+a+"-up",className:L()("Post-vote Post-upvote",r&&"Post-vote--active"),loading:this.voteLoading,disabled:this.voteLoading||!c||!s,onclick:function(){return l(!r,!1)},"aria-label":u().translator.trans("fof-gamification.forum.post.upvote_button")}),m("label",{className:"Post-points"},n.votes()),!i&&b().component({icon:this.voteLoading?void 0:"fas fa-fw fa-"+a+"-down",className:L()("Post-vote Post-downvote",e&&"Post-vote--active"),loading:this.voteLoading,disabled:!c||!s,onclick:function(){return l(!1,!e)},"aria-label":u().translator.trans("fof-gamification.forum.post.downvote_button")})),10)})),(0,l.extend)(p().prototype,"navItems",(function(t){u().forum.attribute("canViewRankingPage")&&t.add("rankings",g().component({href:u().route("rankings"),icon:"fas fa-trophy"},u().translator.trans("fof-gamification.forum.nav.name")),80)})),(0,l.extend)(v().prototype,"sortMap",(function(t){t.hot="-hotness"})),(0,l.extend)(it().prototype,"sortMap",(function(t){t.votes="-votes"})),t=function(t){return function(o){return o&&o.attrs&&o.attrs.className&&String(o.attrs.className).split(" ").includes(t)}},o=function(n,e){var r=[];if(n&&n.children&&Array.isArray(n.children)){var a=n.children.find(t(e));a&&r.push(a),n.children.forEach((function(t){r.push.apply(r,o(t,e))}))}return r},(0,l.extend)(K().prototype,"infoItems",(function(t){var o=this.attrs.user;t.add("points",m("div",null,W()("fas fa-medal"),u().translator.trans("fof-gamification.forum.user.card.points",{count:o.points()})),50)})),(0,l.extend)(K().prototype,"view",(function(n){var e=this.attrs.user,r=o(n,"UserCard-profile")[0],a=Number(B("rankAmt"));if(r){var i=r.children.find(t("UserCard-badges"));return e.ranks()&&(i?e.ranks().reverse().map((function(t,o){if(!a||o<a)return m("li",{className:"User-Rank"},Q(t))})).forEach((function(t){t&&i.children.push(t)})):r.children.splice(1,0,m("ul",{className:"UserCard-badges badges"},e.ranks().reverse().map((function(t,o){if(!a||o<a)return m("li",{className:"User-Rank"},Q(t))}))))),n}})),(0,l.extend)(q().prototype,"view",(function(o){var n,e=this.attrs.post.user();if(!e)return o;var r=o.children.find(t("PostUser-name")),a=null!=(n=Number(B("rankAmt")))?n:e.ranks().length;e.ranks()&&(r.children=r.children.concat(e.ranks().reverse().splice(0,a).map((function(t){return m("span",{className:"Post-Rank"},Q(t))}))).filter((function(t){return void 0!==t.tag})))})),B("showVotesOnDiscussionPage",!0)&&!B("useAlternateLayout",!0)&&((0,l.extend)(C().prototype,"elementAttrs",(function(t){this.attrs.discussion.seeVotes()&&(t.className+=" DiscussionListItem--withVotes")})),(0,l.extend)(C().prototype,"infoItems",(function(t){this.attrs.discussion.seeVotes()&&t.add("discussion-votes",m("span",{className:"DiscussionListItem-votes",title:u().translator.trans("fof-gamification.forum.votes")},W()("far fa-thumbs-up"),$()(this.attrs.discussion.votes())),20)}))),(0,l.extend)(Z().prototype,"oncreate",(function(){u().pusher&&u().pusher.then((function(t){t.pusher.bind("newVote",(function(t){var o,n,e=u().store.getById("posts",t.post_id),r=t.user_id;e&&e.votes()!==t.votes&&r!=u().session.user.id()&&(o=e.id(),(n=et[o])?n(o):(n=et[o]=ot()(nt,1500))(o))}))}))})),(0,l.extend)(Z().prototype,"onremove",(function(){u().pusher&&u().pusher.then((function(t){t.pusher.unbind("newVote")}))})),u().notificationComponents.vote=ct,(0,l.extend)(lt().prototype,"notificationTypes",(function(t){var o,n=null==(o=u().session)?void 0:o.user;null!=n&&null!=n.canHaveVotingNotifications&&n.canHaveVotingNotifications()&&t.add("vote",{name:"vote",icon:"fas fa-thumbs-up",label:u().translator.trans("fof-gamification.forum.notification.prefrences.vote")})})),(0,l.extend)(Z().prototype,"sidebarItems",(function(t){var o=this.discussion.posts()||[],n=null==o?void 0:o[0];null!=n&&null!=n.canSeeVotes&&n.canSeeVotes()&&null!=n&&null!=n.seeVoters&&n.seeVoters()&&u().forum.attribute("fof-gamification-op-votes-only")&&t.add("op-voters",m(wt,{post:n}),90)})),u().routes["user.votes"]={path:"/u/:username/votes",component:kt},(0,l.extend)(xt().prototype,"navItems",(function(t){var o=this.user,n=B("iconName")||"thumbs";t.add("votes",m(g(),{href:u().route("user.votes",{username:o.slug()}),name:"votes",icon:"fas fa-fw fa-"+n+"-up"},u().translator.trans("fof-gamification.forum.user.votes_link")),85)})),B("useAlternateLayout",!0)&&((0,l.extend)(C().prototype,"oninit",(function(){var t=this;this.attrs.discussion.seeVotes()&&this.subtree.check((function(){return t.voteLoading}))})),(0,l.extend)(C().prototype,"view",(function(t){var o=this,n=this.attrs.discussion;if(n.seeVotes()&&t&&t.children){var e=t.children.find((function(t){return t&&t.attrs&&t.attrs.className&&t.attrs.className.includes("DiscussionListItem-content")})),r=n.firstPost(),a=rt(n,"hasUpvoted"),i=rt(n,"hasDownvoted"),s=!u().session.user||rt(n,"canVote"),c=B("upVotesOnly",!0),l=B("iconNameAlt")||"arrow",f=function(t,n){return T(r,t,n,(function(t){return o.voteLoading=t}))};e.children.unshift(m("div",{className:"DiscussionListItem-votes alternateLayout","data-upvotes-only":c},m(b(),{className:"DiscussionListItem-voteButton DiscussionListItem-voteButton--up Button Button--icon Button--text",icon:"fas fa-fw fa-"+l+"-up","data-active":a,disabled:!s||this.voteLoading,onclick:function(){return f(!a,!1)},"aria-label":u().translator.trans("fof-gamification.forum.post.upvote_button")}),m("span",{class:"DiscussionListItem-voteCount"},$()(rt(n,"votes")||0)),!c&&m(b(),{className:"DiscussionListItem-voteButton DiscussionListItem-voteButton--down Button Button--icon Button--text",icon:"fas fa-fw fa-"+l+"-down","data-active":i,disabled:!s||this.voteLoading,onclick:function(){return f(!1,!i)},"aria-label":u().translator.trans("fof-gamification.forum.post.downvote_button")}),this.voteLoading&&m(O(),{display:"inline",size:"small"})))}}))),B("altPostVotingUi",!0)&&((0,l.extend)(N().prototype,"actionItems",(function(t){this.attrs.post.isHidden()||t.remove("votes")})),(0,l.extend)(N().prototype,"classes",(function(t){if(!this.attrs.post.isHidden()){var o=B("upVotesOnly",!0);t.push("votesAlternativeLayout"),o&&t.push("votesUpvotesOnly")}})),(0,l.extend)(N().prototype,"headerItems",(function(t){var o=this,n=this.attrs.post;if(!n.isHidden()&&n.canSeeVotes()){var e=n.hasDownvoted(),r=n.hasUpvoted(),a=B("iconName")||"thumbs",i=B("upVotesOnly",!0),s=n.canSeeVotes(),c=!u().session.user||n.canVote(),l=function(t,e){return T(n,t,e,(function(t){o.voteLoading=t}))};t.add("votes",m("div",{className:"Post-votes alternateLayout","data-upvotes-only":i},m(b(),{className:"Post-voteButton Post-voteButton--up Button Button--icon Button--text",icon:"fas fa-fw fa-"+a+"-up","data-active":r,disabled:!c||this.voteLoading||!s,onclick:function(){return l(!r,!1)},"aria-label":u().translator.trans("fof-gamification.forum.post.upvote_button")}),m("span",{class:"Post-voteCount"},$()(n.votes()||0)),!i&&m(b(),{className:"Post-voteButton Post-voteButton--down Button Button--icon Button--text",icon:"fas fa-fw fa-"+a+"-down","data-active":e,disabled:!c||this.voteLoading,onclick:function(){return l(!1,!e)},"aria-label":u().translator.trans("fof-gamification.forum.post.downvote_button")}),this.voteLoading&&m(O(),{display:"inline",size:"small"})),1e4)}})))}))})(),module.exports=e})();
//# sourceMappingURL=forum.js.map