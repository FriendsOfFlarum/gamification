module.exports=function(t){var n={};function o(e){if(n[e])return n[e].exports;var r=n[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,o),r.l=!0,r.exports}return o.m=t,o.c=n,o.d=function(t,n,e){o.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,n){if(1&n&&(t=o(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(o.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var r in t)o.d(e,r,function(n){return t[n]}.bind(null,r));return e},o.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(n,"a",n),n},o.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},o.p="",o(o.s=51)}([,function(t,n){t.exports=flarum.core.compat["common/extend"]},function(t,n){t.exports=flarum.core.compat["forum/app"]},function(t,n){t.exports=flarum.core.compat["common/Model"]},function(t,n){t.exports=flarum.core.compat["common/components/Button"]},function(t,n,o){"use strict";function e(t,n){return(e=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function r(t,n){t.prototype=Object.create(n.prototype),t.prototype.constructor=t,e(t,n)}o.d(n,"a",(function(){return r}))},,function(t,n){t.exports=flarum.core.compat["common/components/LoadingIndicator"]},function(t,n,o){"use strict";o.d(n,"a",(function(){return s}));var e=o(5),r=o(3),a=o.n(r),i=o(21),s=function(t){function n(){return t.apply(this,arguments)||this}return Object(e.a)(n,t),n}(o.n(i)()(a.a,{points:a.a.attribute("points"),name:a.a.attribute("name"),color:a.a.attribute("color")}))},function(t,n,o){"use strict";function e(t,n){void 0===n&&(n={}),n.style=n.style||{},n.className="rankLabel "+(n.className||"");var o=t.color();return n.style.backgroundColor=n.style.color=o,n.className+=" colored",m("span",n,m("span",{className:"rankLabel-text"},t.name()))}o.d(n,"a",(function(){return e}))},,function(t,n){t.exports=flarum.core.compat["common/models/Post"]},function(t,n){t.exports=flarum.core.compat["common/helpers/icon"]},function(t,n){t.exports=flarum.core.compat["common/helpers/avatar"]},function(t,n){t.exports=flarum.core.compat["common/components/Link"]},function(t,n){t.exports=flarum.core.compat["common/utils/abbreviateNumber"]},function(t,n){t.exports=flarum.core.compat["forum/components/CommentPost"]},function(t,n){t.exports=flarum.core.compat["common/models/Discussion"]},,function(t,n,o){"use strict";o.d(n,"a",(function(){return e}));var e={Rank:o(8).a}},function(t,n,o){"use strict";o.d(n,"a",(function(){return e}));var e={rankLabel:o(9).a}},function(t,n){t.exports=flarum.core.compat["common/utils/mixin"]},function(t,n){t.exports=flarum.core.compat["forum/components/IndexPage"]},function(t,n){t.exports=flarum.core.compat["forum/components/DiscussionListItem"]},function(t,n){t.exports=flarum.core.compat["forum/components/DiscussionPage"]},function(t,n){t.exports=flarum.core.compat["common/helpers/username"]},function(t,n){t.exports=flarum.core.compat["common/utils/classList"]},,function(t,n){t.exports=flarum.core.compat["common/models/User"]},function(t,n){t.exports=flarum.core.compat["forum/components/UserCard"]},function(t,n,o){t.exports=o(50)},function(t,n){t.exports=flarum.core.compat["common/components/Page"]},function(t,n){t.exports=flarum.core.compat["common/helpers/listItems"]},function(t,n){t.exports=flarum.core.compat["forum/states/DiscussionListState"]},function(t,n){t.exports=flarum.core.compat["common/components/LinkButton"]},function(t,n){t.exports=flarum.core.compat["forum/utils/PostControls"]},function(t,n){t.exports=flarum.core.compat["common/components/Modal"]},function(t,n){t.exports=flarum.core.compat["forum/utils/DiscussionControls"]},function(t,n){t.exports=flarum.core.compat["forum/components/PostUser"]},function(t,n,o){(function(n){var o=/^\s+|\s+$/g,e=/^[-+]0x[0-9a-f]+$/i,r=/^0b[01]+$/i,a=/^0o[0-7]+$/i,i=parseInt,s="object"==typeof n&&n&&n.Object===Object&&n,c="object"==typeof self&&self&&self.Object===Object&&self,u=s||c||Function("return this")(),f=Object.prototype.toString,l=Math.max,p=Math.min,m=function(){return u.Date.now()};function d(t){var n=typeof t;return!!t&&("object"==n||"function"==n)}function v(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&"[object Symbol]"==f.call(t)}(t))return NaN;if(d(t)){var n="function"==typeof t.valueOf?t.valueOf():t;t=d(n)?n+"":n}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(o,"");var s=r.test(t);return s||a.test(t)?i(t.slice(2),s?2:8):e.test(t)?NaN:+t}t.exports=function(t,n,o){var e,r,a,i,s,c,u=0,f=!1,h=!1,g=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function y(n){var o=e,a=r;return e=r=void 0,u=n,i=t.apply(a,o)}function b(t){return u=t,s=setTimeout(w,n),f?y(t):i}function x(t){var o=t-c;return void 0===c||o>=n||o<0||h&&t-u>=a}function w(){var t=m();if(x(t))return N(t);s=setTimeout(w,function(t){var o=n-(t-c);return h?p(o,a-(t-u)):o}(t))}function N(t){return s=void 0,g&&e?y(t):(e=r=void 0,i)}function L(){var t=m(),o=x(t);if(e=arguments,r=this,c=t,o){if(void 0===s)return b(c);if(h)return s=setTimeout(w,n),y(c)}return void 0===s&&(s=setTimeout(w,n)),i}return n=v(n)||0,d(o)&&(f=!!o.leading,a=(h="maxWait"in o)?l(v(o.maxWait)||0,n):a,g="trailing"in o?!!o.trailing:g),L.cancel=function(){void 0!==s&&clearTimeout(s),u=0,e=c=r=s=void 0},L.flush=function(){return void 0===s?i:N(m())},L}}).call(this,o(49))},function(t,n){t.exports=flarum.core.compat["common/states/DiscussionListState"]},function(t,n){t.exports=flarum.core.compat["forum/components/Notification"]},function(t,n){t.exports=flarum.core.compat["forum/components/NotificationGrid"]},function(t,n){t.exports=flarum.core.compat["common/Component"]},function(t,n){t.exports=flarum.core.compat["common/components/Tooltip"]},function(t,n){t.exports=flarum.core.compat["common/utils/SubtreeRetainer"]},,,,function(t,n){var o;o=function(){return this}();try{o=o||new Function("return this")()}catch(t){"object"==typeof window&&(o=window)}t.exports=o},function(t,n,o){var e=function(t){"use strict";var n=Object.prototype,o=n.hasOwnProperty,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",a=e.asyncIterator||"@@asyncIterator",i=e.toStringTag||"@@toStringTag";function s(t,n,o){return Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}),t[n]}try{s({},"")}catch(t){s=function(t,n,o){return t[n]=o}}function c(t,n,o,e){var r=n&&n.prototype instanceof l?n:l,a=Object.create(r.prototype),i=new L(e||[]);return a._invoke=function(t,n,o){var e="suspendedStart";return function(r,a){if("executing"===e)throw new Error("Generator is already running");if("completed"===e){if("throw"===r)throw a;return k()}for(o.method=r,o.arg=a;;){var i=o.delegate;if(i){var s=x(i,o);if(s){if(s===f)continue;return s}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if("suspendedStart"===e)throw e="completed",o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);e="executing";var c=u(t,n,o);if("normal"===c.type){if(e=o.done?"completed":"suspendedYield",c.arg===f)continue;return{value:c.arg,done:o.done}}"throw"===c.type&&(e="completed",o.method="throw",o.arg=c.arg)}}}(t,o,i),a}function u(t,n,o){try{return{type:"normal",arg:t.call(n,o)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var f={};function l(){}function p(){}function m(){}var d={};s(d,r,(function(){return this}));var v=Object.getPrototypeOf,h=v&&v(v(O([])));h&&h!==n&&o.call(h,r)&&(d=h);var g=m.prototype=l.prototype=Object.create(d);function y(t){["next","throw","return"].forEach((function(n){s(t,n,(function(t){return this._invoke(n,t)}))}))}function b(t,n){var e;this._invoke=function(r,a){function i(){return new n((function(e,i){!function e(r,a,i,s){var c=u(t[r],t,a);if("throw"!==c.type){var f=c.arg,l=f.value;return l&&"object"==typeof l&&o.call(l,"__await")?n.resolve(l.__await).then((function(t){e("next",t,i,s)}),(function(t){e("throw",t,i,s)})):n.resolve(l).then((function(t){f.value=t,i(f)}),(function(t){return e("throw",t,i,s)}))}s(c.arg)}(r,a,e,i)}))}return e=e?e.then(i,i):i()}}function x(t,n){var o=t.iterator[n.method];if(void 0===o){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=void 0,x(t,n),"throw"===n.method))return f;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var e=u(o,t.iterator,n.arg);if("throw"===e.type)return n.method="throw",n.arg=e.arg,n.delegate=null,f;var r=e.arg;return r?r.done?(n[t.resultName]=r.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=void 0),n.delegate=null,f):r:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,f)}function w(t){var n={tryLoc:t[0]};1 in t&&(n.catchLoc=t[1]),2 in t&&(n.finallyLoc=t[2],n.afterLoc=t[3]),this.tryEntries.push(n)}function N(t){var n=t.completion||{};n.type="normal",delete n.arg,t.completion=n}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(w,this),this.reset(!0)}function O(t){if(t){var n=t[r];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var e=-1,a=function n(){for(;++e<t.length;)if(o.call(t,e))return n.value=t[e],n.done=!1,n;return n.value=void 0,n.done=!0,n};return a.next=a}}return{next:k}}function k(){return{value:void 0,done:!0}}return p.prototype=m,s(g,"constructor",m),s(m,"constructor",p),p.displayName=s(m,i,"GeneratorFunction"),t.isGeneratorFunction=function(t){var n="function"==typeof t&&t.constructor;return!!n&&(n===p||"GeneratorFunction"===(n.displayName||n.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,s(t,i,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},y(b.prototype),s(b.prototype,a,(function(){return this})),t.AsyncIterator=b,t.async=function(n,o,e,r,a){void 0===a&&(a=Promise);var i=new b(c(n,o,e,r),a);return t.isGeneratorFunction(o)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},y(g),s(g,i,"Generator"),s(g,r,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var n=[];for(var o in t)n.push(o);return n.reverse(),function o(){for(;n.length;){var e=n.pop();if(e in t)return o.value=e,o.done=!1,o}return o.done=!0,o}},t.values=O,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(N),!t)for(var n in this)"t"===n.charAt(0)&&o.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function e(o,e){return i.type="throw",i.arg=t,n.next=o,e&&(n.method="next",n.arg=void 0),!!e}for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r],i=a.completion;if("root"===a.tryLoc)return e("end");if(a.tryLoc<=this.prev){var s=o.call(a,"catchLoc"),c=o.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return e(a.catchLoc,!0);if(this.prev<a.finallyLoc)return e(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return e(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return e(a.finallyLoc)}}}},abrupt:function(t,n){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=n&&n<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=n,a?(this.method="next",this.next=a.finallyLoc,f):this.complete(i)},complete:function(t,n){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&n&&(this.next=n),f},finish:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.finallyLoc===t)return this.complete(o.completion,o.afterLoc),N(o),f}},catch:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc===t){var e=o.completion;if("throw"===e.type){var r=e.arg;N(o)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,o){return this.delegate={iterator:O(t),resultName:n,nextLoc:o},"next"===this.method&&(this.arg=void 0),f}},t}(t.exports);try{regeneratorRuntime=e}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}},function(t,n,o){"use strict";o.r(n),o.d(n,"models",(function(){return e.a})),o.d(n,"components",(function(){return Bt})),o.d(n,"helpers",(function(){return Mt}));var e=o(19),r=o(2),a=o.n(r),i=o(3),s=o.n(i),c=o(17),u=o.n(c),f=o(11),l=o.n(f),p=o(28),d=o.n(p),v=o(8),h=o(5),g=o(13),y=o.n(g),b=o(31),x=o.n(b),w=o(22),N=o.n(w),L=o(4),O=o.n(L),k=o(7),j=o.n(k),P=o(32),V=o.n(P),F=o(25),_=o.n(F),I=o(12),S=o.n(I),E=function(t,n){void 0===n&&(n=!1);var o=app.data["fof-gamification."+t];return n?!!parseInt(o):o},G=o(14),R=o.n(G),B=function(t){function n(){return t.apply(this,arguments)||this}Object(h.a)(n,t);var o=n.prototype;return o.oninit=function(n){t.prototype.oninit.call(this,n),app.session.user&&!0===app.session.user.data.attributes.canViewRankingPage||m.route.set("/"),this.loading=!0,this.users=[],this.refresh()},o.view=function(){var t,n=this;return t=this.loading?j.a.component():O.a.component({className:"Button",onclick:this.loadMore.bind(this)},app.translator.trans("core.forum.discussion_list.load_more_button")),m("div",{className:"IndexPage"},N.a.prototype.hero(),m("div",{className:"container"},m("div",{className:"sideNavContainer"},m("nav",{className:"IndexPage-nav sideNav"},m("ul",null,V()(N.a.prototype.sidebarItems().toArray()))),m("div",{className:"IndexPage-results sideNavOffset"},m("table",{class:"rankings"},m("tr",null,m("th",{className:"rankings-mobile"},app.translator.trans("fof-gamification.forum.ranking.rank")),m("th",null,app.translator.trans("fof-gamification.forum.ranking.name")),m("th",null,app.translator.trans("fof-gamification.forum.ranking.amount"))),this.users.map((function(t,o){return++o,[m("tr",{className:"ranking-"+o},o<4?E("customRankingImages",!0)?m("img",{className:"rankings-mobile rankings-image",src:app.forum.attribute("baseUrl")+app.forum.attribute("fof-gamification.topimage"+o+"Url")}):m("td",{className:"rankings-mobile rankings-"+o},S()("fas fa-trophy")):m("td",{className:"rankings-4 rankings-mobile"},n.addOrdinalSuffix(o)),m("td",null,m("div",{className:"PostUser"},m("h3",{className:"rankings-info"},m(R.a,{href:app.route.user(t),force:!0},o<4?y()(t,{className:"info-avatar rankings-"+o+"-avatar"}):""," ",_()(t))))),o<4?m("td",{className:"rankings-"+o},t.points()):m("td",{className:"rankings-4"},t.points()))]}))),m("div",{className:"rankings-loadmore"}," ",t)))))},o.refresh=function(t){var n=this;return void 0===t&&(t=!0),t&&(this.loading=!0,this.users=[]),this.loadResults().then((function(t){n.users=[],n.parseResults(t)}),(function(){n.loading=!1,m.redraw()}))},o.addOrdinalSuffix=function(t){if("en"===app.data.locale){var n=t%10,o=t%100;return 1===n&&11!==o?t+"st":2===n&&12!==o?t+"nd":3===n&&13!==o?t+"rd":t+"th"}return t},o.loadResults=function(t){var n={};return n.page={offset:t,limit:"10"},app.store.find("rankings",n)},o.loadMore=function(){this.loading=!0,this.loadResults(this.users.length).then(this.parseResults.bind(this))},o.parseResults=function(t){return[].push.apply(this.users,t),this.loading=!1,this.users.sort((function(t,n){return parseFloat(n.points())-parseFloat(t.points())})),m.redraw(),t},n}(x.a),D=o(1),U=o(33),M=o.n(U),T=o(34),C=o.n(T),A=function(){Object(D.extend)(N.a.prototype,"navItems",(function(t){app.session.user&&!0===app.session.user.data.attributes.canViewRankingPage&&t.add("rankings",C.a.component({href:app.route("rankings"),icon:"fas fa-trophy"},app.translator.trans("fof-gamification.forum.nav.name")),80)})),Object(D.extend)(M.a.prototype,"sortMap",(function(t){t.hot="-hotness"}))},$=o(16),z=o.n($),W=o(26),Y=o.n(W),q=o(35),H=o.n(q),J=o(36),K=function(t){function n(){return t.apply(this,arguments)||this}Object(h.a)(n,t);var o=n.prototype;return o.className=function(){return"VotesModal Modal--small"},o.title=function(){return app.translator.trans("fof-gamification.forum.modal.title")},o.oninit=function(n){t.prototype.oninit.call(this,n),this.loading=!this.attrs.post.upvotes(),this.loading&&this.load()},o.content=function(){var t=this;return this.loading?m("div",{className:"Modal-body"},m(j.a,null)):m("div",{className:"Modal-body"},m("ul",{className:"VotesModal-list"},["upvotes"].map((function(n){var o=t.attrs.post[n]();if(o&&o.length)return m("div",null,m("legend",null,app.translator.trans("fof-gamification.forum.modal."+n+"_label")),o.map((function(t){return m("li",null,m(R.a,{href:app.route.user(t)},y()(t)," ",_()(t)))})))}))))},o.load=function(){return app.store.find("posts",this.attrs.post.id(),{include:"upvotes"}).then(this.loaded.bind(this))},n}(o.n(J).a),Q=o(37),X=o.n(Q),Z=function(t,n,o,e,r){if(void 0===r&&(r=t.discussion()),app.session.user){if(!r||r.canVote()||t.canVote())return n&&o&&(n=!1,o=!1),e&&e(!0),m.redraw(),t.save([n,o,"vote"]).then((function(){return null}),(function(){return null})).then((function(){e&&e(!1),r&&r.pushAttributes({votes:t.votes()}),m.redraw()}))}else X.a.replyAction.call(r,!0)},tt=function(){Object(D.extend)(H.a,"moderationControls",(function(t,n){n.seeVoters()&&t.add("viewVotes",[m(O.a,{icon:"fas fa-thumbs-up",onclick:function(){app.modal.show(K,{post:n})}},app.translator.trans("fof-gamification.forum.mod_item"))])})),Object(D.extend)(z.a.prototype,"actionItems",(function(t){var n=this,o=this.attrs.post,e=o.hasDownvoted(),r=o.hasUpvoted(),a=E("iconName")||"thumbs",i=E("upVotesOnly",!0),s=o.canSeeVotes(),c=!app.session.user||o.canVote(),u=function(t,e){return Z(o,t,e,(function(t){return n.voteLoading=t}))};t.add("votes",m("div",{className:Y()("CommentPost-votes",E("useAlternateLayout",!0)&&"alternateLayout")},O.a.component({icon:this.voteLoading?void 0:"fas fa-fw fa-"+a+"-up",className:Y()("Post-vote Post-upvote",r&&"Post-vote--active"),loading:this.voteLoading,disabled:this.voteLoading||!c||!s,onclick:function(){return u(!r,!1)},"aria-label":app.translator.trans("fof-gamification.forum.post.upvote_button")}),m("label",{className:"Post-points"},o.votes()),!i&&O.a.component({icon:this.voteLoading?void 0:"fas fa-fw fa-"+a+"-down",className:Y()("Post-vote Post-downvote",e&&"Post-vote--active"),loading:this.voteLoading,disabled:!c||!s,onclick:function(){return u(!1,!e)},"aria-label":app.translator.trans("fof-gamification.forum.post.downvote_button")})),10)}))},nt=o(23),ot=o.n(nt),et=o(15),rt=o.n(et),at=function(){E("showVotesOnDiscussionPage",!0)&&!E("useAlternateLayout",!0)&&Object(D.extend)(ot.a.prototype,"infoItems",(function(t){this.attrs.discussion.seeVotes()&&t.add("discussion-votes",m("span",{className:"DiscussionListItem-votes",title:app.translator.trans("fof-gamification.forum.votes")},S()("far fa-thumbs-up"),rt()(this.attrs.discussion.votes())),20)}))},it=o(38),st=o.n(it),ct=o(29),ut=o.n(ct),ft=o(9),lt=function(){var t=function(t){return function(n){return n&&n.attrs&&n.attrs.className&&String(n.attrs.className).split(" ").includes(t)}};Object(D.extend)(ut.a.prototype,"infoItems",(function(t){var n,o=E("pointsPlaceholder"),e=String(this.attrs.user.points());n=o?m("div",null,o.replace("{points}",e)):app.translator.trans("fof-gamification.forum.user.points",{points:e}),t.add("points",n)})),Object(D.extend)(ut.a.prototype,"view",(function(n){var o=this.attrs.user,e=function n(o,e){var r=[];if(o&&o.children&&Array.isArray(o.children)){var a=o.children.find(t(e));a&&r.push(a),o.children.forEach((function(t){r.push.apply(r,n(t,e))}))}return r}(n,"UserCard-profile")[0],r=Number(E("rankAmt"));if(e){var a=e.children.find(t("UserCard-badges"));return o.ranks()&&(a?o.ranks().reverse().map((function(t,n){if(!r||n<r)return m("li",{className:"User-Rank"},Object(ft.a)(t))})).forEach((function(t){t&&a.children.push(t)})):e.children.splice(1,0,m("ul",{className:"UserCard-badges badges"},o.ranks().reverse().map((function(t,n){if(!r||n<r)return m("li",{className:"User-Rank"},Object(ft.a)(t))}))))),n}})),Object(D.extend)(st.a.prototype,"view",(function(t){var n,o=this.attrs.post.user();if(!o)return t;var e,r=t.children.find((e="h3",function(t){return t&&t.tag&&t.tag===e})),a=null!=(n=Number(E("rankAmt")))?n:o.ranks().length;r.children=r.children.concat(o.ranks().reverse().splice(0,a).map((function(t){return m("span",{className:"Post-Rank"},Object(ft.a)(t))}))).filter((function(t){return void 0!==t.tag}))}))},pt=o(24),mt=o.n(pt),dt=o(39),vt=o.n(dt),ht=function(t){return app.store.find("posts",t).then((function(){return m.redraw()}))},gt=[],yt=function(){Object(D.extend)(mt.a.prototype,"oncreate",(function(){app.pusher&&app.pusher.then((function(t){t.main.bind("newVote",(function(t){var n,o,e=app.store.getById("posts",t.post_id),r=t.user_id;e&&e.votes()!==t.votes&&r!=app.session.user.id()&&(n=e.id(),(o=gt[n])?o(n):(o=gt[n]=vt()(ht,1500))(n))}))}))})),Object(D.extend)(mt.a.prototype,"onremove",(function(){app.pusher&&app.pusher.then((function(t){t.main.unbind("newVote")}))}))},bt=function(t,n){var o=t.firstPost();return o&&void 0!==o[n]()?o[n]():t[n]()};var xt=o(40),wt=o.n(xt);var Nt=o(41),Lt=function(t){function n(){return t.apply(this,arguments)||this}Object(h.a)(n,t);var o=n.prototype;return o.icon=function(){return this.attrs.notification.content()>0?"fas fa-thumbs-up":"fas fa-thumbs-down"},o.href=function(){return a.a.route.post(this.attrs.notification.subject())},o.content=function(){var t=this.attrs.notification.fromUser(),n=parseInt(this.attrs.notification.content());return n>0?a.a.translator.trans("fof-gamification.forum.notification.upvote",{user:t}):a.a.translator.trans("fof-gamification.forum.notification.downvote",{user:t})},o.excerpt=function(){return this.attrs.notification.subject().contentPlain()},n}(o.n(Nt).a),Ot=o(42),kt=o.n(Ot);function jt(t,n,o,e,r,a,i){try{var s=t[a](i),c=s.value}catch(t){return void o(t)}s.done?n(c):Promise.resolve(c).then(e,r)}var Pt=o(30),Vt=o.n(Pt),Ft=o(43),_t=o.n(Ft),It=o(44),St=o.n(It),Et=o(45),Gt=o.n(Et),Rt=function(t){function n(){for(var n,o=arguments.length,e=new Array(o),r=0;r<o;r++)e[r]=arguments[r];return(n=t.call.apply(t,[this].concat(e))||this).subtreeRetainer=void 0,n.lastRenderVotes=-1,n.loading=!1,n}Object(h.a)(n,t);var o=n.prototype;return o.oninit=function(n){var o=this;t.prototype.oninit.call(this,n),this.loading=!this.attrs.post.upvotes(),this.loading&&this.load(),this.subtreeRetainer=new Gt.a((function(){return o.loading}),(function(){return o.attrs.post.votes()}),(function(){var t,n;return null==(t=o.attrs.post)||null==t.upvotes||null==(n=t.upvotes())?void 0:n.length}))},o.onbeforeupdate=function(n){return t.prototype.onbeforeupdate.call(this,n),this.subtreeRetainer.needsRebuild()},o.onupdate=function(t){this.lastRenderVotes!==this.attrs.post.votes()&&(this.loading=!0,setTimeout((function(){return m.redraw()}),0),this.lastRenderVotes=this.attrs.post.votes(),this.load())},o.view=function(){if(!1===this.attrs.post.votes()||!1===this.attrs.post.upvotes())return m("div",{className:"VotingContainer"},m("div",{className:"FoFGamification-voters"},m("div",{className:"FoFGamification-voters-title"},m("span",{className:"FoFGamification-voters-title-icon"},S()("fas fa-users"),m("span",{className:"FoFGamification-voters-title-label"},a.a.translator.trans("fof-gamification.forum.voters.label")),m("span",{className:"FoFGamification-voters-title-label FoFGamification-voters-title-label--mobile"},a.a.translator.trans("fof-gamification.forum.voters.label")))),m(j.a,{display:"inline"})));var t=this.attrs.post.upvotes();return m("div",{className:"VotingContainer"},m("div",{className:"FoFGamification-voters"},m("div",{className:"FoFGamification-voters-title"},m("span",{className:"FoFGamification-voters-title-icon"},S()("fas fa-users"),m("span",{className:"FoFGamification-voters-title-label"},a.a.translator.trans("fof-gamification.forum.voters.label")),m("span",{className:"FoFGamification-voters-title-label FoFGamification-voters-title-label--mobile"},0===t.length?a.a.translator.trans("fof-gamification.forum.voters.label_none"):a.a.translator.trans("fof-gamification.forum.voters.label")))),m("div",{className:"FoFGamification-voters-message"},0===t.length?a.a.translator.trans("fof-gamification.forum.voters.none"):null),m("div",{className:"FoFGamification-voters-list"},t.slice(0,15).map((function(t){return m(R.a,{href:a.a.route("user",{username:t.slug()}),className:"FoFGamification-voters-item"},m(St.a,{text:t.displayName()},y()(t)))})),t.length>15?m("span",{className:"FoFGamification-voters-item FoFGamification-voters-item--plus"},m("span",{className:"Avatar"},"+"+(t.length-15))):null)))},o.load=function(){var t,n=(t=Vt.a.mark((function t(){return Vt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.a.store.find("posts",this.attrs.post.id(),{include:"upvotes"});case 2:this.loading=!1,m.redraw();case 4:case"end":return t.stop()}}),t,this)})),function(){var n=this,o=arguments;return new Promise((function(e,r){var a=t.apply(n,o);function i(t){jt(a,e,r,i,s,"next",t)}function s(t){jt(a,e,r,i,s,"throw",t)}i(void 0)}))});return function(){return n.apply(this,arguments)}}(),n}(_t.a);var Bt={RankingsPage:B,VoteNotification:Lt,VotesModal:K};function Dt(){return(Dt=Object.assign||function(t){for(var n=1;n<arguments.length;n++){var o=arguments[n];for(var e in o)Object.prototype.hasOwnProperty.call(o,e)&&(t[e]=o[e])}return t}).apply(this,arguments)}var Ut=o(20),Mt=Dt({saveVote:Z,setting:E},Ut.a);a.a.initializers.add("fof-gamification",(function(t){u.a.prototype.votes=s.a.attribute("votes"),u.a.prototype.hasUpvoted=s.a.attribute("hasUpvoted"),u.a.prototype.hasDownvoted=s.a.attribute("hasDownvoted"),u.a.prototype.canVote=s.a.attribute("canVote"),u.a.prototype.seeVotes=s.a.attribute("seeVotes"),d.a.prototype.points=s.a.attribute("points"),d.a.prototype.ranks=s.a.hasMany("ranks"),l.a.prototype.upvotes=s.a.hasMany("upvotes"),l.a.prototype.votes=s.a.attribute("votes"),l.a.prototype.canVote=s.a.attribute("canVote"),l.a.prototype.canSeeVotes=s.a.attribute("canSeeVotes"),l.a.prototype.hasUpvoted=s.a.attribute("hasUpvoted"),l.a.prototype.hasDownvoted=s.a.attribute("hasDownvoted"),l.a.prototype.seeVoters=s.a.attribute("seeVoters"),t.store.models.ranks=v.a,t.routes.rankings={path:"/rankings",component:B},tt(),A(),Object(D.extend)(wt.a.prototype,"sortMap",(function(t){t.votes="-votes"})),lt(),at(),yt(),a.a.notificationComponents.vote=Lt,Object(D.extend)(kt.a.prototype,"notificationTypes",(function(t){t.add("vote",{name:"vote",icon:"fas fa-thumbs-up",label:a.a.translator.trans("fof-gamification.forum.notification.prefrences.vote")})})),Object(D.extend)(mt.a.prototype,"sidebarItems",(function(t){var n=this.discussion.posts()[0];t.replace("controls",null,100),t.replace("subscription",null,80),null!=n&&null!=n.canSeeVotes&&n.canSeeVotes()&&a.a.forum.attribute("fof-gamification-op-votes-only")&&t.add("op-voters",m(Rt,{post:n}),90)})),E("useAlternateLayout",!0)&&(Object(D.extend)(ot.a.prototype,"oninit",(function(){var t=this;this.attrs.discussion.seeVotes()&&this.subtree.check((function(){return t.voteLoading}))})),Object(D.extend)(ot.a.prototype,"view",(function(t){var n=this,o=this.attrs.discussion;if(o.seeVotes()&&t&&t.children){var e=t.children.find((function(t){return t&&t.attrs&&t.attrs.className&&t.attrs.className.includes("DiscussionListItem-content")})),r=o.firstPost(),i=bt(o,"hasUpvoted"),s=bt(o,"hasDownvoted"),c=!a.a.session.user||bt(o,"canVote"),u=E("upVotesOnly",!0),f=E("iconNameAlt")||"arrow",l=function(t,o){return Z(r,t,o,(function(t){return n.voteLoading=t}))};e.children.unshift(m("div",{className:"DiscussionListItem-votes alternateLayout","data-upvotes-only":u},m(O.a,{className:"DiscussionListItem-voteButton DiscussionListItem-voteButton--up Button Button--icon Button--text",icon:"fas fa-fw fa-"+f+"-up","data-active":i,disabled:!c||this.voteLoading,onclick:function(){return l(!i,!1)},"aria-label":a.a.translator.trans("fof-gamification.forum.post.upvote_button")}),m("span",{class:"DiscussionListItem-voteCount"},rt()(bt(o,"votes")||0)),!u&&m(O.a,{className:"DiscussionListItem-voteButton DiscussionListItem-voteButton--down Button Button--icon Button--text",icon:"fas fa-fw fa-"+f+"-down","data-active":s,disabled:!c||this.voteLoading,onclick:function(){return l(!1,!s)},"aria-label":a.a.translator.trans("fof-gamification.forum.post.downvote_button")}),this.voteLoading&&m(j.a,{display:"inline",size:"small"})))}}))),E("altPostVotingUi",!0)&&(Object(D.extend)(z.a.prototype,"actionItems",(function(t){t.remove("votes")})),Object(D.extend)(z.a.prototype,"classes",(function(t){var n=E("upVotesOnly",!0);t.push("votesAlternativeLayout"),n&&t.push("votesUpvotesOnly")})),Object(D.extend)(z.a.prototype,"headerItems",(function(t){var n=this,o=this.attrs.post;if(o.canSeeVotes()){var e=o.hasDownvoted(),r=o.hasUpvoted(),i=E("iconName")||"thumbs",s=E("upVotesOnly",!0),c=o.canSeeVotes(),u=!a.a.session.user||o.canVote(),f=function(t,e){return Z(o,t,e,(function(t){n.voteLoading=t}))};t.add("votes",m("div",{className:"Post-votes alternateLayout","data-upvotes-only":s},m(O.a,{className:"Post-voteButton Post-voteButton--up Button Button--icon Button--text",icon:"fas fa-fw fa-"+i+"-up","data-active":r,disabled:!u||this.voteLoading||!c,onclick:function(){return f(!r,!1)},"aria-label":a.a.translator.trans("fof-gamification.forum.post.upvote_button")}),m("span",{class:"Post-voteCount"},rt()(o.votes()||0)),!s&&m(O.a,{className:"Post-voteButton Post-voteButton--down Button Button--icon Button--text",icon:"fas fa-fw fa-"+i+"-down","data-active":e,disabled:!u||this.voteLoading,onclick:function(){return f(!1,!e)},"aria-label":a.a.translator.trans("fof-gamification.forum.post.downvote_button")}),this.voteLoading&&m(j.a,{display:"inline",size:"small"})),1e4)}})))}))}]);
//# sourceMappingURL=forum.js.map