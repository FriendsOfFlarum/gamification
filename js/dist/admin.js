module.exports=function(t){var a={};function n(e){if(a[e])return a[e].exports;var o=a[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=a,n.d=function(t,a,e){n.o(t,a)||Object.defineProperty(t,a,{enumerable:!0,get:e})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,a){if(1&a&&(t=n(t)),8&a)return t;if(4&a&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(n.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&a&&"string"!=typeof t)for(var o in t)n.d(e,o,function(a){return t[a]}.bind(null,o));return e},n.n=function(t){var a=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(a,"a",a),a},n.o=function(t,a){return Object.prototype.hasOwnProperty.call(t,a)},n.p="",n(n.s=44)}([function(t,a){t.exports=flarum.core.compat.extend},function(t,a){t.exports=flarum.core.compat.Model},function(t,a,n){"use strict";function e(t,a){t.prototype=Object.create(a.prototype),t.prototype.constructor=t,t.__proto__=a}n.d(a,"a",(function(){return e}))},function(t,a){t.exports=flarum.core.compat["components/Button"]},function(t,a,n){"use strict";n.d(a,"a",(function(){return r}));var e=n(2),o=n(1),i=n.n(o),s=n(12),r=function(t){function a(){return t.apply(this,arguments)||this}return Object(e.a)(a,t),a}(n.n(s)()(i.a,{points:i.a.attribute("points"),name:i.a.attribute("name"),color:i.a.attribute("color")}))},function(t,a,n){"use strict";function e(t,a){void 0===a&&(a={}),a.style=a.style||{},a.className="rankLabel "+(a.className||"");var n=t.color();return a.style.backgroundColor=a.style.color=n,a.className+=" colored",m("span",a,m("span",{className:"rankLabel-text"},t.name()))}n.d(a,"a",(function(){return e}))},,,,function(t,a){t.exports=flarum.core.compat["components/Switch"]},function(t,a,n){"use strict";n.d(a,"a",(function(){return e}));var e={Rank:n(4).a}},function(t,a,n){"use strict";n.d(a,"a",(function(){return e}));var e={rankLabel:n(5).a}},function(t,a){t.exports=flarum.core.compat["utils/mixin"]},function(t,a){t.exports=flarum.core.compat["components/Page"]},,,,,,,,,,function(t,a){t.exports=flarum.core.compat["components/PermissionGrid"]},,,,,,,,,,,,,function(t,a){t.exports=flarum.core.compat.app},function(t,a){t.exports=flarum.core.compat["components/AdminNav"]},function(t,a){t.exports=flarum.core.compat["components/AdminLinkButton"]},function(t,a){t.exports=flarum.core.compat["components/Alert"]},function(t,a){t.exports=flarum.core.compat["utils/saveSettings"]},function(t,a){t.exports=flarum.core.compat["components/UploadImageButton"]},,,function(t,a,n){"use strict";n.r(a),n.d(a,"models",(function(){return e.a})),n.d(a,"helpers",(function(){return S.a})),n.d(a,"components",(function(){return j}));var e=n(10),o=n(36),i=n.n(o),s=n(0),r=n(23),c=n.n(r),l=n(37),p=n.n(l),u=n(38),f=n.n(u),d=n(2),h=n(39),g=n.n(h),v=n(13),k=n.n(v),b=n(3),w=n.n(b),y=n(40),x=n.n(y),N=n(9),R=n.n(N),P=n(41),_=function(t){function a(){return t.apply(this,arguments)||this}return Object(d.a)(a,t),a.prototype.resourceUrl=function(){return app.forum.attribute("apiUrl")+"/"+this.props.path},a}(n.n(P).a),A=function(t){function a(){return t.apply(this,arguments)||this}Object(d.a)(a,t);var n=a.prototype;return n.init=function(){var t=this;this.fields=["convertedLikes","amountPerPost","amountPerDiscussion","postStartAmount","rankAmt","iconName","blockedUsers","pointsPlaceholder"],this.switches=["autoUpvotePosts","customRankingImages","rateLimit","showVotesOnDiscussionPage","useAlternateLayout"],this.ranks=app.store.all("ranks"),this.values={},this.settingsPrefix="fof-gamification";var a=app.data.settings;this.fields.forEach((function(n){return t.values[n]=m.prop(a[t.addPrefix(n)])})),this.switches.forEach((function(n){return t.values[n]=m.prop(!!Number(a[t.addPrefix(n)]))})),this.newRank={points:m.prop(""),name:m.prop(""),color:m.prop("")}},n.view=function(){var t=this;return[m("div",{className:"SettingsPage"},[m("div",{className:"container"},[m("form",{onsubmit:this.onsubmit.bind(this)},[m("div",{className:"helpText"},app.translator.trans("fof-gamification.admin.page.convert.help")),void 0===this.values.convertedLikes()?w.a.component({type:"button",className:"Button Button--warning Ranks-button",children:app.translator.trans("fof-gamification.admin.page.convert.button"),onclick:function(){app.request({url:app.forum.attribute("apiUrl")+"/fof/gamification/convert",method:"POST"}).then(t.values.convertedLikes("converting"))}}):"converting"===this.values.convertedLikes()?m("label",{},app.translator.trans("fof-gamification.admin.page.convert.converting")):m("label",{},app.translator.trans("fof-gamification.admin.page.convert.converted",{number:this.values.convertedLikes()})),m("fieldset",{className:"SettingsPage-ranks"},[m("legend",{},app.translator.trans("fof-gamification.admin.page.ranks.title")),m("label",{},app.translator.trans("fof-gamification.admin.page.ranks.ranks")),m("div",{className:"helpText"},app.translator.trans("fof-gamification.admin.page.ranks.help.help")),m("div",{className:"Ranks--Container"},this.ranks.map((function(a){return m("div",{style:"float: left;"},[m("input",{className:"FormControl Ranks-number",type:"number",value:a.points(),placeholder:app.translator.trans("fof-gamification.admin.page.ranks.help.points"),oninput:m.withAttr("value",t.updatePoints.bind(t,a))}),m("input",{className:"FormControl Ranks-name",value:a.name(),placeholder:app.translator.trans("fof-gamification.admin.page.ranks.help.name"),oninput:m.withAttr("value",t.updateName.bind(t,a))}),m("input",{className:"FormControl Ranks-color",value:a.color(),placeholder:app.translator.trans("fof-gamification.admin.page.ranks.help.color"),oninput:m.withAttr("value",t.updateColor.bind(t,a))}),w.a.component({type:"button",className:"Button Button--warning Ranks-button",icon:"fa fa-times",onclick:t.deleteRank.bind(t,a)})])})),m("div",{style:"float: left; margin-bottom: 15px"},[m("input",{className:"FormControl Ranks-number",value:this.newRank.points(),placeholder:app.translator.trans("fof-gamification.admin.page.ranks.help.points"),type:"number",oninput:m.withAttr("value",this.newRank.points)}),m("input",{className:"FormControl Ranks-name",value:this.newRank.name(),placeholder:app.translator.trans("fof-gamification.admin.page.ranks.help.name"),oninput:m.withAttr("value",this.newRank.name)}),m("input",{className:"FormControl Ranks-color",value:this.newRank.color(),placeholder:app.translator.trans("fof-gamification.admin.page.ranks.help.color"),oninput:m.withAttr("value",this.newRank.color)}),w.a.component({type:"button",className:"Button Button--warning Ranks-button",icon:"fa fa-plus",onclick:this.addRank.bind(this)})])),m("label",{},app.translator.trans("fof-gamification.admin.page.ranks.number_title")),m("input",{className:"FormControl Ranks-default",value:this.values.rankAmt()||"",placeholder:2,oninput:m.withAttr("value",this.values.rankAmt)}),m("legend",{},app.translator.trans("fof-gamification.admin.page.votes.title")),m("label",{},app.translator.trans("fof-gamification.admin.page.votes.icon_name")),m("div",{className:"helpText"},app.translator.trans("fof-gamification.admin.page.votes.icon_help")),m("input",{className:"FormControl Ranks-default",value:this.values.iconName()||"",placeholder:"thumbs",oninput:m.withAttr("value",this.values.iconName)}),R.a.component({state:this.values.autoUpvotePosts()||!1,children:app.translator.trans("fof-gamification.admin.page.votes.auto_upvote"),onchange:this.values.autoUpvotePosts,className:"votes-switch"}),R.a.component({state:this.values.rateLimit()||!1,children:app.translator.trans("fof-gamification.admin.page.votes.rate_limit"),onchange:this.values.rateLimit,className:"votes-switch"}),R.a.component({state:this.values.showVotesOnDiscussionPage()||!1,children:app.translator.trans("fof-gamification.admin.page.votes.discussion_page"),onchange:this.values.showVotesOnDiscussionPage,className:"votes-switch"}),R.a.component({state:this.values.useAlternateLayout()||!1,children:app.translator.trans("fof-gamification.admin.page.votes.alternate_layout"),onchange:this.values.useAlternateLayout,className:"votes-switch"}),m("label",{},app.translator.trans("fof-gamification.admin.page.votes.points_title")),m("input",{className:"FormControl Ranks-default",value:this.values.pointsPlaceholder()||"",placeholder:app.translator.trans("fof-gamification.admin.page.votes.points_placeholder")+"{points}",oninput:m.withAttr("value",this.values.pointsPlaceholder)}),m("legend",{},app.translator.trans("fof-gamification.admin.page.rankings.title")),R.a.component({state:this.values.customRankingImages()||!1,children:app.translator.trans("fof-gamification.admin.page.rankings.enable"),onchange:this.values.customRankingImages,className:"votes-switch"}),m("label",{},app.translator.trans("fof-gamification.admin.page.rankings.blocked.title")),m("input",{className:"FormControl Ranks-blocked",placeholder:app.translator.trans("fof-gamification.admin.page.rankings.blocked.placeholder"),value:this.values.blockedUsers()||"",oninput:m.withAttr("value",this.values.blockedUsers)}),m("div",{className:"helpText"},app.translator.trans("fof-gamification.admin.page.rankings.blocked.help"))].concat([1,2,3].map((function(t){return[m("label",{className:"Upload-label"},app.translator.trans("fof-gamification.admin.page.rankings.custom_image_"+t)),m(_,{className:"Upload-button",name:"fof-gamification.topimage"+t,path:"fof/gamification/topimage"+t}),m("br",null)]})),[w.a.component({type:"submit",className:"Button Button--primary Ranks-save",children:app.translator.trans("fof-gamification.admin.page.save_settings"),loading:this.loading,disabled:!this.changed()})]))])])])]},n.updateName=function(t,a){t.save({name:a})},n.updatePoints=function(t,a){t.save({points:a})},n.updateColor=function(t,a){t.save({color:a})},n.deleteRank=function(t){var a=this;t.delete(),this.ranks.some((function(n,e){if(n.data.id===t.data.id)return a.ranks.splice(e,1),!0}))},n.addRank=function(t){var a=this;app.store.createRecord("ranks").save({points:this.newRank.points(),name:this.newRank.name(),color:this.newRank.color()}).then((function(t){a.newRank.color(""),a.newRank.name(""),a.newRank.points(""),a.ranks.push(t),m.redraw()}))},n.changed=function(){var t=this,a=this.switches.some((function(a){return t.values[a]()!==("1"==app.data.settings[t.addPrefix(a)])}));return this.fields.some((function(a){return t.values[a]()!==app.data.settings[t.addPrefix(a)]}))||a},n.onsubmit=function(t){var a=this;if(t.preventDefault(),!this.loading){this.loading=!0,app.alerts.dismiss(this.successAlert);var n={};this.switches.forEach((function(t){return n[a.addPrefix(t)]=a.values[t]()})),this.fields.forEach((function(t){return n[a.addPrefix(t)]=a.values[t]()})),x()(n).then((function(){app.alerts.show(a.successAlert=new g.a({type:"success",children:app.translator.trans("core.admin.basics.saved_message")}))})).catch((function(){})).then((function(){a.loading=!1,window.location.reload()}))}},n.addPrefix=function(t){return this.settingsPrefix+"."+t},a}(k.a),O=function(){app.routes["fof-gamification"]={path:"/fof/gamification",component:A.component()},app.extensionSettings["fof-gamification"]=function(){return m.route(app.route("fof-gamification"))},Object(s.extend)(p.a.prototype,"items",(function(t){t.add("fof-gamification",f.a.component({href:app.route("fof-gamification"),icon:"fas fa-thumbs-up",children:"Gamification",description:app.translator.trans("fof-gamification.admin.nav.desc")}))}))},L=n(4),S=n(11),j={SettingsPage:A};i.a.initializers.add("fof-gamification",(function(t){t.store.models.ranks=L.a,Object(s.extend)(c.a.prototype,"replyItems",(function(a){a.add("Vote",{icon:"fas fa-thumbs-up",label:t.translator.trans("fof-gamification.admin.permissions.vote_label"),permission:"discussion.votePosts"})})),Object(s.extend)(c.a.prototype,"viewItems",(function(a){a.add("canSeeVotes",{icon:"fas fa-info-circle",label:t.translator.trans("fof-gamification.admin.permissions.see_votes_label"),permission:"discussion.canSeeVotes"}),a.add("canViewRankingPage",{icon:"fas fa-trophy",label:t.translator.trans("fof-gamification.admin.permissions.see_ranking_page"),permission:"fof.gamification.viewRankingPage",allowGuest:!0})})),O()}))}]);
//# sourceMappingURL=admin.js.map